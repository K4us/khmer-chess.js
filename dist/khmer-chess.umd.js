!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var n=t();for(var i in n)("object"==typeof exports?exports:e)[i]=n[i]}}(self,(function(){return(()=>{"use strict";var e={198:function(e,t,n){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var r=i(n(876)),o=i(n(604)),u=i(n(679)),a=i(n(19)),s=function(){function e(e){var t=a.default.fromString(e);this.kpgn=new o.default(t)}return e.prototype.loadKpng=function(e){this.kpgn.fromJson(e)},e.prototype.resetBoard=function(){this.kpgn.ren=a.default.fromString()},e.prototype.getCanMoves=function(){return this.kpgn.ren.genAllCanMoves()},e.prototype.getCanMovePointsByPoint=function(e){return this.kpgn.ren.getCanMovePointsByPoint(e)},e.prototype.validateRENStr=function(e){try{return a.default.fromString(e),{valid:!0,error_number:0,error:"No errors."}}catch(e){return{valid:!1,error_number:1,error:e.message}}},e.prototype.getRENStr=function(){return this.kpgn.ren.toString()},Object.defineProperty(e.prototype,"piecesInBoardMultiArray",{get:function(){return this.kpgn.ren.board.piecesMultiArray},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"piecesInBoard",{get:function(){return this.kpgn.ren.board.pieces},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"piecesInGraveyard",{get:function(){return this.kpgn.ren.graveyard.pieces},enumerable:!1,configurable:!0}),e.prototype.getKPGN=function(){return this.kpgn.toJson()},e.prototype.loadKpgn=function(e,t){this.kpgn=new o.default(this.kpgn.ren)},e.prototype.drawAscii=function(){return(0,u.default)(this.kpgn.ren)},Object.defineProperty(e.prototype,"turn",{get:function(){return this.kpgn.ren.turn},set:function(e){this.kpgn.ren.turn=e},enumerable:!1,configurable:!0}),e.prototype.move=function(e,t){var n=this.kpgn.ren.move(e,t);return this.kpgn.moves.push(n),n},e.prototype.clearBoard=function(){this.kpgn.ren=a.default.fromString("4k3/8/8/8/8/8/8/3K4 w ---- -- -.- bhgqghbffffffffFFFFFFFFBHGQGHB")},e.prototype.getHistories=function(){return this.kpgn.moves},e.title=r.default.name,e.version=r.default.version,e}();t.default=s},945:function(e,t,n){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var r=n(946),o=i(n(273)),u=function(){function e(e,t){o.default.isUndefined(t)&&(t=(e=e[0])[1]),this.h=e,this.v=Number(t)}return Object.defineProperty(e.prototype,"x",{get:function(){return r.HORIZONTAL_CODE_LETTERS.indexOf(this.h)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this.v-1},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"indexCode",{get:function(){return""+this.h+this.v},enumerable:!1,configurable:!0}),e}();t.default=u},639:function(e,t,n){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var r=i(n(863)),o=i(n(255)),u=n(946),a=function(){function e(){}return Object.defineProperty(e.prototype,"isWhiteTurn",{get:function(){return r.default.isWhiteColor(this.currentTurn)},enumerable:!1,configurable:!0}),e.prototype.init=function(e){this.piecesString=e.piecesString,this.currentTurn=e.currentTurn,this.isQueenMoved=e.isQueenMoved,this.isKingMoved=e.isKingMoved,this.genCanMove=e.genCanMove,this.genCanMoveForAnother=e.genCanMoveForAnother,this.whiteMoves=[],this.blackMoves=[],this.whiteKingInDanger=null,this.whiteKingWillInDanger=null,this.blackKingInDanger=null,this.blackKingWillInDanger=null,this.winColor=null,this.stuckColor=null},e.prototype.generateCanMoves=function(){var e=this,t=o.default.filterPieceInBoard(this.piecesString);this.whiteMoves=t.whitePieces,this.blackMoves=t.blackPieces;var n=function(t){t.forEach((function(t){var n=e.isKingMoved;t.piece.isTypeKing||(n=!!t.piece.isTypeQueen&&e.isQueenMoved);var i=e.genCanMovePointsByPiecePoint(t.point,t.piece,e.piecesString,n);t.canMovePoints=i}))};n(this.whiteMoves),n(this.blackMoves)},e.prototype.cleanPieceNoMove=function(){var e=function(e){for(var t=!0;t;){t=!1;for(var n=0;n<e.length;n++)if(!e[n].canMovePoints.length){e.splice(n,1),t=!0;break}}};e(this.whiteMoves),e(this.blackMoves)},e.prototype.checkIfKingInDanger=function(){this.whiteKingInDanger=o.default.getKingInDanger(u.PIECE_COLOR_WHITE,this.piecesString),this.whiteKingWillInDanger=o.default.getKingWillInDanger(u.PIECE_COLOR_WHITE,this.piecesString),this.blackKingInDanger=o.default.getKingInDanger(u.PIECE_COLOR_BLACK,this.piecesString),this.blackKingWillInDanger=o.default.getKingWillInDanger(u.PIECE_COLOR_BLACK,this.piecesString)},e.prototype.genWinLost=function(){this.whiteKingInDanger&&!this.whiteMoves.length?this.winColor=u.PIECE_COLOR_BLACK:this.blackKingInDanger&&!this.blackMoves.length&&(this.winColor=u.PIECE_COLOR_WHITE)},e.prototype.getStuck=function(){this.winColor||(this.isWhiteTurn&&!this.whiteMoves.length?this.stuckColor=u.PIECE_COLOR_WHITE:this.isWhiteTurn||this.blackMoves.length||(this.stuckColor=u.PIECE_COLOR_BLACK))},e.prototype.calcCanMove=function(e){this.init(e),this.generateCanMoves(),this.cleanPieceNoMove();var t=[];this.genCanMove&&(t=this.isWhiteTurn?this.whiteMoves:this.blackMoves);var n=[];return this.genCanMoveForAnother&&(n=this.isWhiteTurn?this.blackMoves:this.whiteMoves),{moves:t,anotherMoves:n}},e.prototype.calcState=function(e){return this.init(e),this.generateCanMoves(),this.cleanPieceNoMove(),this.checkIfKingInDanger(),this.genWinLost(),this.getStuck(),{blackKingInDanger:this.blackKingInDanger,whiteKingInDanger:this.whiteKingInDanger,blackKingWillInDanger:this.blackKingWillInDanger,whiteKingWillInDanger:this.whiteKingWillInDanger,winColor:this.winColor,stuckColor:this.stuckColor,blackCountable:o.default.checkCountable(u.PIECE_COLOR_BLACK,this.piecesString),whiteCountable:o.default.checkCountable(u.PIECE_COLOR_WHITE,this.piecesString)}},e.prototype.calCount=function(e){var t=e.color,n=e.piecesString,i=e.force;return o.default.checkCount(t,n,i)},e.prototype.genCanMovePointsByPiecePoint=function(e,t,n,i){return o.default.genCanMovePointsByPiecePoint(e.index,t,n,i)},e}();t.default=a},41:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0});var i=n(946),r=function(){function e(e,t,n,i){this.x=e,this.y=t,this.width=n,this.height=i}return e.prototype.isContainsPoint=function(e){var t=e.x,n=e.y;return this.x<=t&&this.x+this.width>=t&&this.y<=n&&this.y+this.height>=n},e.isValidPoint=function(t){return new e(0,0,i.ROW_LAST_INDEX,i.ROW_LAST_INDEX).isContainsPoint(t)},e}();t.default=r},255:function(e,t,n){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var r=i(n(273)),o=i(n(149)),u=n(946),a=i(n(135)),s=i(n(863)),c=i(n(41)),l=n(362),f=(0,o.default)(),p=function(){function e(){this.convertMask=function(e,t,n){var i=s.default.isWhiteColor(n)?1:-1,r=a.default.fromIndex(t);return e.x=e.x*i+r.x,e.y=e.y*i+r.y,c.default.isValidPoint(e)?e.index:null}}return e.prototype.getCharPieceFromString=function(e,t){return a.default.isIndexInBoard(t)&&e.length===u.CELL_COUNT?e[t]:u.EMPTY_PIECE},e.prototype.getCharPieceInPos=function(e,t){return this.getCharPieceFromString(t,e)},e.prototype.getPieceByIndex=function(e,t){var n=this.getCharPieceInPos(e,t);return{isValidPiece:s.default.isValidPiece(n),piece:s.default.fromCharCode(n)}},e.prototype.getPieceCanMovePoses=function(e,t){var n=this,i=[];return f[t.type].forEach((function(o){var u=n.convertMask(new a.default(o[0],o[1]),e,t.color);r.default.isNull(u)||i.push(u)})),i},e.prototype.getPieceCanMovePosesValid=function(e,t,n){for(var i=this.getPieceCanMovePoses(e,t),o=[],u=i.length,s=a.default.fromIndex(e),c=0;c<u;c++){var l=a.default.fromIndex(i[c]),f=this.getPieceByIndex(l.index,n);if(f.isValidPiece?(t.color===f.piece.color||t.isTypeFish&&l.x===s.x)&&(l=null):t.isTypeFish&&l.x!==s.x&&(l=null),!r.default.isNull(l)&&t.isTypeBoat){var p=s.x,h=s.y;if(l.x===s.x){for(var d=Math.abs(l.y-s.y),E=s.y<l.y?1:-1;--d>0;)if(this.getPieceByIndex(a.default.xyToIndex(p,h+E*d),n).isValidPiece){l=null;break}}else if(l.y===s.y)for(d=Math.abs(l.x-s.x),E=s.x<l.x?1:-1;--d>0;)if(this.getPieceByIndex(a.default.xyToIndex(p+E*d,h),n).isValidPiece){l=null;break}}r.default.isNull(l)||o.push(i[c])}return o},e.prototype.replacePiecesStringAtIndex=function(e,t,n){return e.substring(0,n)+t+e.substring(n+1)},e.prototype.injectPiece=function(e,t,n){var i=e[t];return this.isCharPiecesInBoard(i,e)?(e=this.replacePiecesStringAtIndex(e,u.EMPTY_PIECE,t),e=this.replacePiecesStringAtIndex(e,i,n)):null},e.prototype.getKingWillInDanger=function(e,t){for(var n=t.indexOf(new s.default(u.PIECE_TYPE_KING,e).pieceCharCode),i=t.length,r=0;r<i;r++){var o=this.getPieceByIndex(r,t);if(o.isValidPiece&&o.piece.color!==e&&o.piece.isTypeBoat)for(var c=this.getPieceCanMovePoses(r,o.piece),l=0;l<c.length;l++)if(c[l]===n)return[a.default.fromIndex(r),a.default.fromIndex(n)]}return null},e.prototype.getKingInDanger=function(e,t){for(var n=t.indexOf(new s.default(u.PIECE_TYPE_KING,e).pieceCharCode),i=t.length,r=0;r<i;r++){var o=this.getPieceByIndex(r,t);if(o.isValidPiece&&o.piece.color!==e)for(var c=this.getPieceCanMovePosesValid(r,o.piece,t),l=0;l<c.length;l++)if(c[l]===n)return[a.default.fromIndex(r),a.default.fromIndex(n)]}return null},e.prototype.genCanMovePointsByPiecePoint=function(e,t,n,i){var o=this.getPieceCanMovePosesValid(e,t,n),u=this.isHaveCaptured(n);if(t.isTypeKing)u||i||((s=this.convertMask(new a.default(2,1),e,t.color))&&!this.getPieceByIndex(s,n).isValidPiece&&o.push(s),(s=this.convertMask(new a.default(-2,1),e,t.color))&&!this.getPieceByIndex(s,n).isValidPiece&&o.push(s));else if(t.isTypeQueen){var s;u||i||(s=this.convertMask(new a.default(-0,2),e,t.color))&&!this.getPieceByIndex(s,n).isValidPiece&&o.push(s)}for(var c=o.length,l=[],f=0;f<c;f++){var p=this.injectPiece(n,e,o[f]);r.default.isNull(this.getKingInDanger(t.color,p))&&l.push(a.default.fromIndex(o[f]))}return l},e.prototype.isCharPiecesInBoard=function(e,t){return!!~t.indexOf(e)},e.prototype.getPiecesInBoard=function(e){return e.split("").filter((function(e){return s.default.isValidPiece(e)}))},e.prototype.isHaveCaptured=function(e){return this.getPiecesInBoard(e).length<4*u.ROW_NUMBER},e.prototype.filterPieceInBoard=function(e){for(var t=[],n=[],i=0;i<e.length;i++){var r=e[i];if(s.default.isValidPiece(r)){var o=new l.PieceIndex(a.default.fromIndex(i),s.default.fromCharCode(r));o.piece.isColorWhite?t.push(o):n.push(o)}}return{whitePieces:t,blackPieces:n}},e.prototype.extractPiecesToArray=function(e){var t,n=e.split(""),i=((t={})[u.PIECE_COLOR_BLACK]=[],t[u.PIECE_COLOR_WHITE]=[],t);return n.forEach((function(e){if(e!==u.EMPTY_PIECE){var t=s.default.fromCharCode(e);i[t.color].push(t.type)}})),i},e.prototype.isStateCount=function(e,t){return 1===this.extractPiecesToArray(t)[e].length},e.prototype.checkCountable=function(e,t){var n=this.extractPiecesToArray(t),i=n[e],r=n[s.default.oppositeColor(e)];return i.length<=2&&r.length>=2},e.prototype.checkCount=function(e,t,n){var i,r,o=function(e,t){return e.join("").split(t).length-1},a=this.extractPiecesToArray(t),c=a[e],l=a[s.default.oppositeColor(e)];if(1===c.length&&l.length>1){if(i=l,r=u.PIECE_TYPE_FISH,!~i.indexOf(r)){var f=64,p=o(l,u.PIECE_TYPE_BOAT);return p?f=p>1?8:16:o(l,u.PIECE_TYPE_GENERAL)>1?f=22:o(l,u.PIECE_TYPE_HORSE)>1?f=32:o(l,u.PIECE_TYPE_GENERAL)&&(f=44),[l.length+1,f]}return[0,64]}return n&&this.checkCountable(e,t)?[0,64]:null},e.prototype.isUpgradable=function(e,t){if(e.isTypeFish){if(e.isColorBlack&&t.y<=2)return!0;if(e.isColorWhite&&t.y>=5)return!0}return!1},e}();t.default=new p},946:(e,t)=>{var n,i,r,o;Object.defineProperty(t,"__esModule",{value:!0}),t.VERTICAL_NOTE_LETTERS_ENGLISH=t.HORIZONTAL_NOTE_LETTERS_ENGLISH=t.VERTICAL_NOTE_LETTERS=t.HORIZONTAL_NOTE_LETTERS=t.HORIZONTAL_CODE_LETTERS=t.CELL_COUNT=t.ROW_LAST_INDEX=t.ROW_FIRST_INDEX=t.ROW_NUMBER=t.BOARD_SEPARATOR=t.PIECE_COLOR_EMPTY=t.EMPTY_PIECE=t.PIECE_NAMES_ENGLISH=t.PIECE_NAMES=t.PIECE_TYPE_TRANSFORM_FISH=t.PIECE_TYPE_FISH=t.PIECE_TYPE_QUEEN=t.PIECE_TYPE_KING=t.PIECE_TYPE_GENERAL=t.PIECE_TYPE_HORSE=t.PIECE_TYPE_BOAT=t.COLOR_NAMES_ENGLISH=t.COLOR_NAMES=t.PIECE_COLOR_BLACK=t.PIECE_COLOR_WHITE=void 0,t.PIECE_COLOR_WHITE="w",t.PIECE_COLOR_BLACK="b",t.COLOR_NAMES=((n={})[t.PIECE_COLOR_BLACK]="ខ្មៅ",n[t.PIECE_COLOR_WHITE]="ស",n),t.COLOR_NAMES_ENGLISH=((i={})[t.PIECE_COLOR_BLACK]="black",i[t.PIECE_COLOR_WHITE]="white",i),t.PIECE_TYPE_BOAT="b",t.PIECE_TYPE_HORSE="h",t.PIECE_TYPE_GENERAL="g",t.PIECE_TYPE_KING="k",t.PIECE_TYPE_QUEEN="q",t.PIECE_TYPE_FISH="f",t.PIECE_TYPE_TRANSFORM_FISH="t",t.PIECE_NAMES=((r={})[t.PIECE_TYPE_BOAT]="ទូក",r[t.PIECE_TYPE_HORSE]="សេះ",r[t.PIECE_TYPE_GENERAL]="គោល",r[t.PIECE_TYPE_KING]="ស្តេច",r[t.PIECE_TYPE_QUEEN]="នាង",r[t.PIECE_TYPE_FISH]="ត្រី",r[t.PIECE_TYPE_TRANSFORM_FISH]="ត្រីបក",r),t.PIECE_NAMES_ENGLISH=((o={})[t.PIECE_TYPE_BOAT]="boat",o[t.PIECE_TYPE_HORSE]="horse",o[t.PIECE_TYPE_GENERAL]="general",o[t.PIECE_TYPE_KING]="king",o[t.PIECE_TYPE_QUEEN]="queen",o[t.PIECE_TYPE_FISH]="fish",o[t.PIECE_TYPE_TRANSFORM_FISH]="transformed-fish",o),t.EMPTY_PIECE=".",t.PIECE_COLOR_EMPTY=".",t.BOARD_SEPARATOR="/",t.ROW_NUMBER=8,t.ROW_FIRST_INDEX=0,t.ROW_LAST_INDEX=7,t.CELL_COUNT=t.ROW_NUMBER*t.ROW_NUMBER,t.HORIZONTAL_CODE_LETTERS="abcdefgh",t.HORIZONTAL_NOTE_LETTERS=["ក","ខ","គ","ឃ","ង","ច","ឆ","ជ"],t.VERTICAL_NOTE_LETTERS=["១","២","៣","៤","៥","៦","៧","៨","៩","១០","១១","១២","១៣","១៤","១៥","១៦","១៧","១៨","១៩","២០","២១","២២","២៣","២៤","២៥","២៦","២៧","២៨","២៩","៣០"],t.HORIZONTAL_NOTE_LETTERS_ENGLISH="abcdefgh",t.VERTICAL_NOTE_LETTERS_ENGLISH=Array.from({length:30},(function(e,t){return""+(t+1)}))},149:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0});var i=n(946);t.default=function(){var e={};return e[i.PIECE_TYPE_BOAT]=[[0,1],[0,2],[0,3],[0,4],[0,5],[0,6],[0,7],[0,8],[0,-1],[0,-2],[0,-3],[0,-4],[0,-5],[0,-6],[0,-7],[0,-8],[1,0],[2,0],[3,0],[4,0],[5,0],[6,0],[7,0],[8,0],[-1,0],[-2,0],[-3,0],[-4,0],[-5,0],[-6,0],[-7,0],[-8,0]],e[i.PIECE_TYPE_HORSE]=[[-1,-2],[1,-2],[-2,-1],[2,-1],[-1,2],[1,2],[-2,1],[2,1]],e[i.PIECE_TYPE_QUEEN]=[[-1,-1],[1,-1],[-1,1],[1,1]],e[i.PIECE_TYPE_GENERAL]=e[i.PIECE_TYPE_QUEEN].concat([[0,1]]),e[i.PIECE_TYPE_KING]=e[i.PIECE_TYPE_GENERAL].concat([[0,-1],[1,0],[-1,0]]),e[i.PIECE_TYPE_FISH]=[[0,1],[-1,1],[1,1]],e[i.PIECE_TYPE_TRANSFORM_FISH]=e[i.PIECE_TYPE_QUEEN],e}},977:function(e,t,n){var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),r=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||i(t,e,n)},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.MoveHelper=t.HVPont=t.jsis=t.genMask=t.boardHelper=t.Rectangle=void 0;var u=n(41);Object.defineProperty(t,"Rectangle",{enumerable:!0,get:function(){return o(u).default}});var a=n(255);Object.defineProperty(t,"boardHelper",{enumerable:!0,get:function(){return o(a).default}});var s=n(149);Object.defineProperty(t,"genMask",{enumerable:!0,get:function(){return o(s).default}});var c=n(273);Object.defineProperty(t,"jsis",{enumerable:!0,get:function(){return o(c).default}});var l=n(945);Object.defineProperty(t,"HVPont",{enumerable:!0,get:function(){return o(l).default}});var f=n(639);Object.defineProperty(t,"MoveHelper",{enumerable:!0,get:function(){return o(f).default}}),r(n(946),t)},273:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0});var n={isValid:function(e){return!this.isNull(e)&&!this.isUndefined(e)},isNull:function(e){return null===e},isUndefined:function(e){return void 0===e},isString:function(e){return this.isValid(e)&&"string"==typeof e},isNotEmpty:function(e){return this.isValidString(e)&&""!=e},isNumber:function(e){return this.isValid(e)&&"number"==typeof e},isStringNumber:function(e){return this.isString(e)&&""!=e&&!isNaN(Number(e))},isArray:function(e){return this.isValid(e)&&e instanceof Array},isFunction:function(e){return this.isValid(e)&&"function"==typeof e},isObject:function(e){return this.isValid(e)&&e instanceof Object},isBoolean:function(e){return this.isValid(e)&&"boolean"==typeof e},isTrue:function(e){return this.isValidBoolean(e)&&e},isFalse:function(e){return this.isValidBoolean(e)&&!e},isPoint:function(e){return this.isValid(e)&&this.isValidObject(e)&&this.isValidNumber(e.x)&&this.isValidNumber(e.y)},isSize:function(e){return this.isValid(e)&&this.isValidObject(e)&&this.isValidNumber(e.width)&&this.isValidNumber(e.height)},isOdd:function(e){return!!(e%2)},isEven:function(e){return!this.isOdd(e)},isUpperCase:function(e){return e===e.toUpperCase()}};t.default=n},303:function(e,t,n){var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),r=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||i(t,e,n)},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.KhmerChess=void 0,r(n(977),t),r(n(997),t),r(n(362),t),r(n(148),t);var u=n(198);Object.defineProperty(t,"KhmerChess",{enumerable:!0,get:function(){return o(u).default}})},672:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0});t.default=function(e){var t=e.piece,n=e.fromBoardPoint,i=e.toGraveyardPoint;this.piece=t,this.fromBoardPoint=n,this.toGraveyardPoint=i}},604:function(e,t,n){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var r=i(n(19)),o=i(n(762)),u=i(n(106)),a=i(n(10)),s=i(n(334)),c=function(){function e(e){this.event="",this.date=null,this.location="",this.players={white:new u.default({}),black:new u.default({})},this.result={last:{whiteWin:!1,blackWin:!1},white:new a.default({})},this.timer=new s.default({}),this.ren=e,this.moves=[]}return Object.defineProperty(e.prototype,"latestMove",{get:function(){return this.moves[this.moves.length-1]||null},enumerable:!1,configurable:!0}),e.prototype.loadRENStr=function(e){this.ren=r.default.fromString(e)},e.prototype.loadMovesStrings=function(e){var t=this.ren;this.moves=e.reverse().map((function(e){var n=o.default.fromString(e,t);return t=t.backRen(n),n})).reverse()},e.prototype.validateOption=function(e){},e.prototype.fromJson=function(e){this.validateOption(e);var t=e.ren,n=e.moves,i=e.timer,o=e.result,c=e.players,l=e.location,f=e.date,p=e.event;this.event=p||this.event,this.date=f?new Date(f):this.date,this.location=l||this.location,c&&(this.players={white:new u.default(c.white),black:new u.default(c.black)}),o&&(this.result={last:o.last,white:new a.default(o.white)}),this.ren=r.default.fromString(t||""),this.loadMovesStrings(n||[]),this.timer=new s.default(i||{})},e.prototype.toJson=function(){return{event:this.event,date:this.date?this.date.toString():"",location:this.location,players:{white:this.players.white.toJson(),black:this.players.black.toJson()},result:{last:{whiteWin:this.result.last.whiteWin,blackWin:this.result.last.blackWin},white:this.result.white.toJson()},timer:this.timer.toJson(),moves:this.moves.map((function(e){return e.toString()})),ren:this.ren.toString()}},e.prototype.fromBase64=function(e){},e.prototype.toBase64=function(){return""},e}();t.default=c},762:function(e,t,n){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var r=n(977),o=n(362),u=n(72),a=i(n(863)),s=i(n(135)),c=i(n(672)),l=function(){function e(e){var t=e.piece,n=e.moveFrom,i=e.moveTo,u=e.isUpgrading,a=e.captured;this.boardStatus={attacker:null,winColor:null,stuckColor:null,startCountingColor:null,countingDownColor:null,drawCountColor:null},this.startCountingFrom=0,this.piece=t,this.moveFrom=n,this.moveTo=i,this.isUpgrading=!!u,this.captured=a||null,r.boardHelper.isUpgradable(t,i)&&(this.isUpgrading=!0,t.upgrade()),this.kqJumping=new o.KqJumped}return e.prototype.setRen=function(e){e.checkBoardStatus(this),e.kqJumped.checkKQMoved(this),this.renStr=e.toString()},Object.defineProperty(e.prototype,"isWhiteKingJumping",{get:function(){return!!this.kqJumping.whiteKing},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isWhiteQueenJumping",{get:function(){return!!this.kqJumping.whiteQueen},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isBlackKingJumping",{get:function(){return!!this.kqJumping.blackKing},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isBlackQueenJumping",{get:function(){return!!this.kqJumping.blackQueen},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"attacker",{get:function(){return this.boardStatus.attacker||null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"winColor",{get:function(){return this.boardStatus.winColor||null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"stuckColor",{get:function(){return this.boardStatus.stuckColor||null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"drawCountColor",{get:function(){return this.boardStatus.drawCountColor||null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isDraw",{get:function(){return this.stuckColor||this.drawCountColor},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isGameOver",{get:function(){return this.winColor||this.isDraw},enumerable:!1,configurable:!0}),e.fromString=function(t,n){var i=a.default.fromCharCode(t[0]),r=s.default.fromIndexCode(t.substr(1,2)),l=s.default.fromIndexCode(t.substr(3,2)),f=new e({piece:i,moveFrom:r,moveTo:l}),p=t.indexOf(u.PIECE_FLAG_KILL);if(~p){var h=Number(t.substr(p+1).match(/^(\d+)/)[1]),d=n.graveyard.get(h);if(!d)throw new Error("Invalid captured index");f.captured=new c.default({fromBoardPoint:l,toGraveyardPoint:s.default.fromIndexGraveyardIndex(h),piece:d})}var E=t.indexOf(u.PIECE_FLAG_JUMP);if(~E){var g=Number(t.substr(E+1).match(/^(\d+)/)[1]);f.kqJumping=o.KqJumped.fromNumber(g)}var _=t.indexOf(u.PIECE_FLAG_START_COUNTING);return~_&&(f.startCountingFrom=Number(t.substr(_+1).match(/^(\d+)/)[1])),f.setRen(n),f},e.prototype.toString=function(){var e=this.piece.pieceCharCode,t=this.moveFrom.indexCode,n=this.moveTo.indexCode,i="";return this.captured&&(i+=u.PIECE_FLAG_KILL+this.captured.toGraveyardPoint.index),this.kqJumping.isJumped&&(i+=u.PIECE_FLAG_JUMP+this.kqJumping.toNumber()),this.isUpgrading&&(i+=u.PIECE_FLAG_UPGRADE),this.startCountingFrom&&(i+=u.PIECE_FLAG_START_COUNTING+this.startCountingFrom),""+e+t+n+i},e.prototype.getJumpingMessage=function(e){var t="";return e?(this.isWhiteKingJumping&&(t+=" white king jumping"),this.isWhiteQueenJumping&&(t+=" white queen jumping"),this.isBlackKingJumping&&(t+=" black king jumping"),this.isBlackQueenJumping&&(t+=" black queen jumping")):(this.isWhiteKingJumping&&(t+=" ស្តេច​ស​ភ្លោះ"),this.isWhiteQueenJumping&&(t+=" នាង​ស​ភ្លោះ"),this.isBlackKingJumping&&(t+=" ស្តេច​ខ្មៅ​ភ្លោះ"),this.isBlackQueenJumping&&(t+=" នាង​ខ្មៅ​ភ្លោះ")),t},e.prototype.getMessage=function(e){if(e){var t="";this.captured&&(t=" captures "+this.captured.piece.titleEnglish);var n=this.isUpgrading?" transforms":"",i=this.getJumpingMessage(e);return this.piece.titleEnglish+" moved from "+this.moveFrom.titleEnglish+" to "+this.moveTo.titleEnglish+n+t+" "+i}return t="",this.captured&&(t=" ស៊ី"+this.captured.piece.title),n=this.isUpgrading?" បក":"",i=this.getJumpingMessage(e),this.piece.title+" ដើរ​ពី "+this.moveFrom.title+" ទៅ "+this.moveTo.title+n+t+" "+i},e}();t.default=l},106:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){var t=e.id,n=e.name;this.id=t||"",this.name=n||""}return e.prototype.toJson=function(){return{id:this.id,name:this.name}},e}();t.default=n},10:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){var t=e.win,n=e.draw,i=e.lost;this.win=t||0,this.draw=n||0,this.lost=i||0}return e.prototype.toJson=function(){return{win:this.win,draw:this.draw,lost:this.lost}},e}();t.default=n},334:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){var t=e.totalSecond,n=e.bonusTime,i=e.currentWhite,r=e.currentBlack;this.bonusTime=n||0,this.totalSecond=t||0,this.currentWhite=i||0,this.currentBlack=r||0}return e.prototype.fromJson=function(){},e.prototype.toJson=function(){return{totalSecond:this.totalSecond,bonusTime:this.bonusTime,currentWhite:this.currentWhite,currentBlack:this.currentBlack}},e}();t.default=n},997:function(e,t,n){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Timer=t.Result=t.Player=t.Captured=t.Move=t.KPGN=void 0;var r=n(604);Object.defineProperty(t,"KPGN",{enumerable:!0,get:function(){return i(r).default}});var o=n(762);Object.defineProperty(t,"Move",{enumerable:!0,get:function(){return i(o).default}});var u=n(672);Object.defineProperty(t,"Captured",{enumerable:!0,get:function(){return i(u).default}});var a=n(106);Object.defineProperty(t,"Player",{enumerable:!0,get:function(){return i(a).default}});var s=n(10);Object.defineProperty(t,"Result",{enumerable:!0,get:function(){return i(s).default}});var c=n(334);Object.defineProperty(t,"Timer",{enumerable:!0,get:function(){return i(c).default}})},231:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){this._onEventListeners={},this._propEvent=[],this._onEventListeners={},this._propEvent=[],this.events=e.events}return e.prototype._checkPropEvent=function(){if(!this._isLockProp)for(;this._propEvent.length;){var e=this._propEvent.shift();this._checkOnEvent(e.name,e.data)}},e.prototype._addPropEvent=function(e,t){this._propEvent.push({name:e,data:t}),this._checkPropEvent()},e.prototype._guardEventName=function(e){if(!e)throw new Error("invalid event name")},e.prototype._checkOnEvent=function(e,t){this._guardEventName(e),this._onEventListeners[e]=this._onEventListeners[e]||[],this._onEventListeners[e].forEach((function(e){e(t)}))},e.prototype._addOnEventListener=function(e,t){this._guardEventName(e),this._onEventListeners[e]=this._onEventListeners[e]||[],this._onEventListeners[e].push(t)},e.prototype._removeOnEventListener=function(e,t){this._guardEventName(e),this._onEventListeners[e]=this._onEventListeners[e]||[];var n=this._onEventListeners[e].indexOf(t);~n&&this._onEventListeners[e].splice(n,1)},e}();t.default=n},148:function(e,t,n){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.table=t.EventHandler=void 0;var r=n(231);Object.defineProperty(t,"EventHandler",{enumerable:!0,get:function(){return i(r).default}});var o=n(679);Object.defineProperty(t,"table",{enumerable:!0,get:function(){return i(o).default}})},679:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=e.board.piecesMultiArray;return t.reverse().reduce((function(e,n,i){return e+"\n"+(8-i)+" ┃"+n.map((function(e){return" "+(e?e.pieceCharCode:" ")+" "})).join("┃")+"┃\n  "+(i===t.length-1?"┗━━━┻━━━┻━━━┻━━━┻━━━┻━━━┻━━━┻━━━┛":"┣━━━╋━━━╋━━━╋━━━╋━━━╋━━━╋━━━╋━━━┫")}),"  ┏━━━┳━━━┳━━━┳━━━┳━━━┳━━━┳━━━┳━━━┓")+"\n    a   b   c   d   e   f   g   h\n  ┏"+e.graveyard.pieces.map((function(){return"━━━"})).join("┳")+"┓\n  ┃"+e.graveyard.pieces.map((function(e){return" "+(e?e.pieceCharCode:" ")+" "})).join("┃")+"┃\n  ┗"+e.graveyard.pieces.map((function(){return"━━━"})).join("┻")+"┛"}},191:function(e,t,n){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var r=i(n(863)),o=i(n(568)),u=n(72),a=n(946),s=i(n(135)),c=function(){function e(e){this.pieceIndices=Array.from({length:a.CELL_COUNT},(function(e,t){var n=s.default.fromIndex(t);return new o.default(n,null)})),e||(e=u.DEFAULT_BOARD_STR);var t=this.extract(e).replace(/\//g,"");if(t.length<a.CELL_COUNT||!r.default.isValidPiecesString(t))throw new Error("Invalid board string "+e);this.pieceIndices=t.split("").map((function(e,t){var n=s.default.fromIndex(t);return new o.default(n,e===a.EMPTY_PIECE?null:r.default.fromCharCode(e))}))}return Object.defineProperty(e.prototype,"piecesMultiArray",{get:function(){var e=[[],[],[],[],[],[],[],[]];return this.pieceIndices.forEach((function(t){e[t.point.y][t.point.x]=t.piece})),e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"pieces",{get:function(){return this.pieceIndices.map((function(e){return e.piece}))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"whiteKing",{get:function(){return this.pieceIndices.find((function(e){return e.piece&&e.piece.isTypeKing&&e.piece.isColorWhite}))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"blackKing",{get:function(){return this.pieceIndices.find((function(e){return e.piece&&e.piece.isTypeKing&&e.piece.isColorBlack}))},enumerable:!1,configurable:!0}),e.prototype.getKing=function(e){return r.default.isWhiteColor(e)?this.whiteKing:this.blackKing},e.prototype.compress=function(e){var t=new RegExp("(\\"+a.EMPTY_PIECE+"+)","g");return e.replace(t,(function(e){return e.length}))},e.prototype.extract=function(e){return e.replace(/(\d+)/g,(function(e){return Array.from({length:e},(function(){return a.EMPTY_PIECE})).join("")}))},e.prototype.toStringFull=function(e){return void 0===e&&(e=this.pieceIndices),e.map((function(e,t){var n=e.toPieceCharCode();return t&&t%a.ROW_NUMBER==0&&t!==a.CELL_COUNT?""+a.BOARD_SEPARATOR+n:n})).join("")},e.prototype.toStringFullNoSeparate=function(){var e=this.toStringFull();return e.replace(/\//g,"")},e.prototype.toString=function(e){var t=this.toStringFull(e);return this.compress(t)},e.prototype.getPieceAtIndex=function(e){return this.pieceIndices[e].piece},e.prototype.setPieceAtIndex=function(e,t){this.pieceIndices[e].piece=t},e}();t.default=c},177:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0});var i=n(72),r=function(){function e(){this.countingDownFromNumber=null,this.whiteCountingDownNumber=null,this.blackCountingDownNumber=null}return Object.defineProperty(e.prototype,"isCountDownWhite",{get:function(){return null!==this.whiteCountingDownNumber},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isCountDownBlack",{get:function(){return null!==this.blackCountingDownNumber},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isCountingDown",{get:function(){return null!==this.countingDownFromNumber},enumerable:!1,configurable:!0}),e.fromString=function(t){t||(t=i.NOT_SET+"."+i.NOT_SET+"@"+i.NOT_SET);var n=new e,r=t.split("@");r[1]!==i.NOT_SET&&(n.countingDownFromNumber=Number(r[1]));var o=r[0].split(".");return o[0]!==i.NOT_SET&&(n.whiteCountingDownNumber=Number(o[0])),o[1]!==i.NOT_SET&&(n.blackCountingDownNumber=Number(o[1])),n},e.prototype.toString=function(){var e=""+(this.isCountDownWhite?this.whiteCountingDownNumber:i.NOT_SET);return(e+="."+(this.isCountDownBlack?this.blackCountingDownNumber:i.NOT_SET))+"@"+(this.isCountingDown?this.countingDownFromNumber:i.NOT_SET)},e}();t.default=r},717:function(e,t,n){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var r=i(n(863)),o=function(){function e(e){if(this.pieces=[],e){if(e.length>30||!r.default.isValidPiecesString(e,!0))throw new Error("Invalid graveyard string "+e);this.pieces=e.split("").map((function(t,n){var i=r.default.fromCharCode(t);if(i.isTypeKing)throw new Error("King cannot die graveyard:"+e);return i}))}}return Object.defineProperty(e.prototype,"lastIndex",{get:function(){return this.pieces.length-1},enumerable:!1,configurable:!0}),e.prototype.get=function(e){return this.pieces[e]},e.prototype.removeAtIndex=function(e){return this.get(e)&&this.pieces.splice(e,1),!0},e.prototype.toString=function(){return this.pieces.map((function(e){return e.pieceCharCode})).join("")},e}();t.default=o},999:function(e,t,n){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var r=n(946),o=n(72),u=i(n(863)),a=function(){function e(e){this.whiteKing=!1,this.blackKing=!1,e&&(this.whiteKing=!!~e.indexOf(u.default.toWhiteCharCode(r.PIECE_TYPE_KING)),this.blackKing=!!~e.indexOf(r.PIECE_TYPE_KING))}return e.prototype.toString=function(){return""+(this.whiteKing?u.default.toWhiteCharCode(r.PIECE_TYPE_KING):o.NOT_SET)+""+(this.blackKing?r.PIECE_TYPE_KING:o.NOT_SET)},e}();t.default=a},832:function(e,t,n){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var r=n(946),o=n(72),u=i(n(863)),a=function(){function e(e){var t;this.whiteKing=!1,this.whiteQueen=!1,this.blackKing=!1,this.blackQueen=!1,this.keyCodes={blackKing:u.default.toWhiteCharCode(r.PIECE_TYPE_QUEEN),whiteKing:u.default.toWhiteCharCode(r.PIECE_TYPE_KING),whiteQueen:r.PIECE_TYPE_KING,blackQueen:r.PIECE_TYPE_QUEEN},this.codeKeys=((t={})[u.default.toWhiteCharCode(r.PIECE_TYPE_QUEEN)]="blackKing: ",t[u.default.toWhiteCharCode(r.PIECE_TYPE_KING)]="whiteKing: ",t[r.PIECE_TYPE_KING]="whiteQueen: ",t[r.PIECE_TYPE_QUEEN]="blackQueen: ",t),e&&(this.whiteKing=!!~e.indexOf(u.default.toWhiteCharCode(r.PIECE_TYPE_KING)),this.whiteQueen=!!~e.indexOf(u.default.toWhiteCharCode(r.PIECE_TYPE_QUEEN)),this.blackKing=!!~e.indexOf(r.PIECE_TYPE_KING),this.blackQueen=!!~e.indexOf(r.PIECE_TYPE_QUEEN))}return Object.defineProperty(e.prototype,"isJumped",{get:function(){return this.whiteKing||this.whiteQueen||this.blackKing||this.blackQueen},enumerable:!1,configurable:!0}),e.prototype.setProp=function(e,t){this[e]=t},e.prototype.applyJumping=function(e,t){this[e]||(t.kqJumping.setProp(e,!0),this.setProp(e,!0))},e.prototype.checkKQMoved=function(e){(e.attacker||e.captured)&&(this.applyJumping("whiteKing",e),this.applyJumping("blackKing",e),this.applyJumping("whiteQueen",e),this.applyJumping("blackQueen",e));var t=e.piece;t.isTypeKing?t.isColorWhite?this.applyJumping("whiteKing",e):this.applyJumping("blackKing",e):t.isTypeQueen&&(t.isColorWhite?this.applyJumping("whiteQueen",e):this.applyJumping("blackQueen",e))},e.prototype.toString=function(){var e=""+(this.whiteKing?u.default.toWhiteCharCode(r.PIECE_TYPE_KING):o.NOT_SET);return e+=""+(this.whiteQueen?u.default.toWhiteCharCode(r.PIECE_TYPE_QUEEN):o.NOT_SET),(e+=""+(this.blackKing?r.PIECE_TYPE_KING:o.NOT_SET))+""+(this.blackQueen?r.PIECE_TYPE_QUEEN:o.NOT_SET)},e.prototype.toNumber=function(){var e=""+(this.whiteKing?1:0);return e+=""+(this.whiteQueen?1:0),e+=""+(this.blackKing?1:0),e+=""+(this.blackQueen?1:0),parseInt(e,2)},e.fromNumber=function(t){var n=("0000"+Number(t).toString(2)).substr(-4),i=new e;return i.whiteKing="1"===n[0],i.whiteQueen="1"===n[1],i.blackKing="1"===n[2],i.blackQueen="1"===n[3],i},e}();t.default=a},863:function(e,t,n){var i=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var i,r=0,o=t.length;r<o;r++)!i&&r in t||(i||(i=Array.prototype.slice.call(t,0,r)),i[r]=t[r]);return e.concat(i||Array.prototype.slice.call(t))},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=n(946),u=r(n(273)),a=function(){function e(t,n){this.type=e.toNormalCharCode(t),this.color=n}return Object.defineProperty(e.prototype,"colorOpponent",{get:function(){return e.oppositeColor(this.color)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"pieceCharCode",{get:function(){return this.isColorWhite?this.pieceCharCodeWhite:this.type},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"pieceCharCodeWhite",{get:function(){return e.toWhiteCharCode(this.type)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"title",{get:function(){return""+o.PIECE_NAMES[this.type]+o.COLOR_NAMES[this.color]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"titleEnglish",{get:function(){return o.COLOR_NAMES_ENGLISH[this.color]+"-"+o.PIECE_NAMES_ENGLISH[this.type]},enumerable:!1,configurable:!0}),e.prototype._isTypeEqual=function(e){return this.type===e},Object.defineProperty(e.prototype,"isTypeKing",{get:function(){return this._isTypeEqual(o.PIECE_TYPE_KING)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isTypeQueen",{get:function(){return this._isTypeEqual(o.PIECE_TYPE_QUEEN)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isTypeBoat",{get:function(){return this._isTypeEqual(o.PIECE_TYPE_BOAT)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isTypeHorse",{get:function(){return this._isTypeEqual(o.PIECE_TYPE_HORSE)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isTypeGeneral",{get:function(){return this._isTypeEqual(o.PIECE_TYPE_GENERAL)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isTypeFish",{get:function(){return this._isTypeEqual(o.PIECE_TYPE_FISH)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isTypeTransformedFish",{get:function(){return this._isTypeEqual(o.PIECE_TYPE_TRANSFORM_FISH)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isColorBlack",{get:function(){return e.isBlackColor(this.color)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isColorWhite",{get:function(){return e.isWhiteColor(this.color)},enumerable:!1,configurable:!0}),e.fromCharCode=function(t){if(!e.isValidPiece(t))return null;var n=e.isWhiteCharCode(t)?o.PIECE_COLOR_WHITE:o.PIECE_COLOR_BLACK,i=e.toNormalCharCode(t);return new e(i,n)},Object.defineProperty(e.prototype,"originPiece",{get:function(){return this.isTypeTransformedFish?new e(o.PIECE_TYPE_FISH,this.color):this},enumerable:!1,configurable:!0}),Object.defineProperty(e,"pieceChars",{get:function(){return[o.PIECE_TYPE_BOAT,o.PIECE_TYPE_HORSE,o.PIECE_TYPE_GENERAL,o.PIECE_TYPE_KING,o.PIECE_TYPE_QUEEN,o.PIECE_TYPE_FISH,o.PIECE_TYPE_TRANSFORM_FISH]},enumerable:!1,configurable:!0}),Object.defineProperty(e,"colorChars",{get:function(){return[o.PIECE_COLOR_WHITE,o.PIECE_COLOR_BLACK]},enumerable:!1,configurable:!0}),e.toWhiteCharCode=function(e){return e.toUpperCase()},e.isWhiteCharCode=function(e){return u.default.isUpperCase(e)},e.toBlackCharCode=function(e){return e.toLowerCase()},e.toNormalCharCode=function(t){return e.toBlackCharCode(t)},e.isValidPiece=function(e){return e!==o.EMPTY_PIECE},e.isWhiteColor=function(e){return e===o.PIECE_COLOR_WHITE},e.isBlackColor=function(e){return e===o.PIECE_COLOR_BLACK},e.oppositeColor=function(t){return e.isWhiteColor(t)?o.PIECE_COLOR_BLACK:o.PIECE_COLOR_WHITE},e.isValidPiecesString=function(e,t){var n=t?s.filter((function(e){return!~[o.EMPTY_PIECE,o.BOARD_SEPARATOR].indexOf(e)})):s;return!e.split("").some((function(e){return!~n.indexOf(e)}))},e.prototype.upgrade=function(){return!!this.isTypeFish&&(this.type=o.PIECE_TYPE_TRANSFORM_FISH,!0)},e.prototype.downgrade=function(){return!!this.isTypeTransformedFish&&(this.type=o.PIECE_TYPE_FISH,!0)},e.prototype.clone=function(){return e.fromCharCode(this.pieceCharCode)},e}();t.default=a;var s=i(i(i([],a.pieceChars,!0),a.pieceChars.map((function(e){return a.toWhiteCharCode(e)})),!0),[o.EMPTY_PIECE,o.BOARD_SEPARATOR],!1)},568:function(e,t,n){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var r=n(946),o=i(n(273)),u=function(){function e(e,t){this.canMovePoints=[],this.point=e,this.piece=t}return e.prototype.toCode=function(){return o.default.isNull(this.piece)?""+this.piece.pieceCharCode+this.point.indexCode:null},e.prototype.toPieceCharCode=function(){return o.default.isNull(this.piece)?r.EMPTY_PIECE:this.piece.pieceCharCode},e}();t.default=u},135:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0});var i=n(946),r=function(){function e(e,t){this.x=e,this.y=t}return Object.defineProperty(e.prototype,"index",{get:function(){return e.xyToIndex(this.x,this.y)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"graveyardIndex",{get:function(){return this.x},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"indexCode",{get:function(){return""+this.h+this.v},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"title",{get:function(){return""+i.HORIZONTAL_NOTE_LETTERS[this.x]+i.VERTICAL_NOTE_LETTERS[this.y]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"titleEnglish",{get:function(){return this.indexCode},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"h",{get:function(){return i.HORIZONTAL_CODE_LETTERS[this.x]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"v",{get:function(){return this.y+1},enumerable:!1,configurable:!0}),e.xyToIndex=function(e,t){return t*i.ROW_NUMBER+e},e.indexCodeToXY=function(e){return{x:i.HORIZONTAL_CODE_LETTERS.indexOf(e[0]),y:Number(e[1])-1}},e.indexCodeToIndex=function(t){var n=e.indexCodeToXY(t),i=n.x,r=n.y;return e.xyToIndex(i,r)},e.fromIndexCode=function(t){var n=e.indexCodeToXY(t);return new e(n.x,n.y)},e.indexToXY=function(e){return{x:e%i.ROW_NUMBER,y:Math.floor(e/i.ROW_NUMBER)}},e.fromIndex=function(t){var n=e.indexToXY(t);return new e(n.x,n.y)},e.fromIndexGraveyardIndex=function(t){return new e(t,0)},e.isIndexInBoard=function(e){return e>=0&&e<=i.CELL_COUNT-1},e}();t.default=r},19:function(e,t,n){var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var r=i(n(191)),o=i(n(832)),u=i(n(999)),a=i(n(177)),s=i(n(717)),c=n(72),l=n(997),f=i(n(762)),p=i(n(135)),h=i(n(863)),d=n(362),E=i(n(639)),g=n(946),_=i(n(273)),C=function(){function e(e){this.moveHelper=new E.default,this.init(e)}return e.prototype.init=function(e){var t=e.boardStr,n=e.turnStr,i=e.kqJumpedStr,c=e.kAttackedStr,l=e.countdownStr,f=e.graveyardStr;this.board=new r.default(t),this.turn=n||g.PIECE_COLOR_WHITE,this.kqJumped=new o.default(i),this.kAttacked=new u.default(c),this.countdown=a.default.fromString(l),this.graveyard=new s.default(f);var p=this.isInvalidPieceCount();if(p){var h="Invalid piece string board:"+t;throw new Error(h+=", graveyard:"+f+", count:"+p)}this.moveHelper=new E.default},e.prototype.isInvalidPieceCount=function(){var e=this.board.pieceIndices.map((function(e){return e.piece})).filter((function(e){return!_.default.isNull(e)})).concat(this.graveyard.pieces).map((function(e){return e.originPiece})).reduce((function(e,t){return e[t.pieceCharCode]=e[t.pieceCharCode]||0,e[t.pieceCharCode]++,e}),{}),t=Object.keys(e).map((function(t){return""+t+e[t]})).sort().join("");return t!==c.STRING_COUNT&&t},e.prototype.backRen=function(t){var n=e.fromString(this.toString());return n.moveBack(t),n},e.prototype.move=function(e,t){var n=this.board.getPieceAtIndex(e);if(!n)return null;this.board.setPieceAtIndex(e,null);var i=new f.default({moveFrom:p.default.fromIndex(e),moveTo:p.default.fromIndex(t),piece:n.clone()}),r=this.board.getPieceAtIndex(t);return r&&(this.graveyard.pieces.push(r),i.captured=new l.Captured({fromBoardPoint:p.default.fromIndex(t),toGraveyardPoint:p.default.fromIndex(this.graveyard.lastIndex),piece:r})),this.board.setPieceAtIndex(t,n),this.turn=h.default.oppositeColor(n.color),i.setRen(this),i},e.prototype.moveBack=function(e){var t=e.moveTo.index,n=e.moveFrom.index,i=this.board.getPieceAtIndex(t);if(this.board.setPieceAtIndex(t,null),!i)return!1;if(this.board.setPieceAtIndex(n,i),e.captured){var r=e.captured.toGraveyardPoint.index,o=this.graveyard.get(r);this.board.setPieceAtIndex(t,o),this.graveyard.removeAtIndex(r)}return e.kqJumping.whiteKing&&(this.kqJumped.whiteKing=!1),e.kqJumping.whiteQueen&&(this.kqJumped.whiteQueen=!1),e.kqJumping.blackKing&&(this.kqJumped.blackKing=!1),e.kqJumping.blackQueen&&(this.kqJumped.blackQueen=!1),e.startCountingFrom&&(e.startCountingFrom===this.countdown.blackCountingDownNumber?this.countdown.blackCountingDownNumber=null:e.startCountingFrom===this.countdown.whiteCountingDownNumber&&(this.countdown.whiteCountingDownNumber=null)),this.turn=i.color,!0},e.fromString=function(t){t||(t=c.DEFAULT_BOARD_STR);var n=t.split(" ");return new e({boardStr:n[0],turnStr:n[1],kqJumpedStr:n[2],kAttackedStr:n[3],countdownStr:n[4],graveyardStr:n[5]})},e.prototype.toString=function(){var e=this.board.toString();return e+=" "+this.turn.toString(),e+=" "+this.kqJumped.toString(),e+=" "+this.kAttacked.toString(),(e+=" "+this.countdown.toString())+" "+this.graveyard.toString()},Object.defineProperty(e.prototype,"isQueenMoved",{get:function(){return h.default.isWhiteColor(this.turn)&&this.kqJumped.whiteQueen||h.default.isBlackColor(this.turn)&&this.kqJumped.blackQueen},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isKingMoved",{get:function(){return h.default.isWhiteColor(this.turn)&&this.kqJumped.whiteKing||h.default.isBlackColor(this.turn)&&this.kqJumped.blackKing},enumerable:!1,configurable:!0}),e.prototype.genAllCanMoves=function(){return this.moveHelper.calcCanMove({piecesString:this.board.toStringFullNoSeparate(),currentTurn:this.turn,isQueenMoved:this.isQueenMoved,isKingMoved:this.isKingMoved,genCanMove:!0,genCanMoveForAnother:!1}).moves},e.prototype.isHasMoved=function(e){var t=!1;return(this.kqJumped.blackKing&&e.isColorBlack&&e.isTypeKing||this.kqJumped.whiteKing&&e.isColorWhite&&e.isTypeKing||this.kqJumped.blackQueen&&e.isColorBlack&&e.isTypeQueen||this.kqJumped.whiteQueen&&e.isColorWhite&&e.isTypeQueen)&&(t=!0),t},e.prototype.getCanMovePointsByPoint=function(e){var t=this.board.getPieceAtIndex(e.index);return _.default.isNull(t)?[]:this.moveHelper.genCanMovePointsByPiecePoint(e,t,this.board.toStringFullNoSeparate(),this.isHasMoved(t))},e.prototype.checkBoardStatus=function(e){var t=this,n=this.moveHelper.calcState({piecesString:this.board.toStringFullNoSeparate(),currentTurn:this.turn,isQueenMoved:this.isQueenMoved,isKingMoved:this.isKingMoved,genCanMove:!1,genCanMoveForAnother:!1});if(!this.countdown.isCountingDown&&(n.blackCountable||n.whiteCountable)){var i=this.moveHelper.calCount({color:n.whiteCountable?g.PIECE_COLOR_WHITE:g.PIECE_COLOR_BLACK,piecesString:this.board.toStringFullNoSeparate(),force:!1});console.log(i)}var r=n.blackKingInDanger||n.whiteKingInDanger;if(r){var o=r.map((function(e){return new d.PieceIndex(e,t.board.getPieceAtIndex(e.index))})).filter((function(e){return!e.piece.isTypeKing}))[0];e.boardStatus.attacker=o}e.boardStatus.winColor=n.winColor,e.boardStatus.stuckColor=n.stuckColor},e.prototype.getWinColor=function(){return this.moveHelper.calcState({piecesString:this.board.toStringFullNoSeparate(),currentTurn:this.turn,isQueenMoved:this.isQueenMoved,isKingMoved:this.isKingMoved,genCanMove:!1,genCanMoveForAnother:!1}).winColor},e}();t.default=C},72:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.EVENT_FLAG_COUNT_DOWN_OUT=t.EVENT_FLAG_COUNTING_DOWN=t.EVENT_FLAG_START_COUNTING=t.EVENT_FLAG_DRAW=t.EVENT_FLAG_WIN=t.EVENT_FLAG_ATTACK=t.PIECE_FLAG_START_COUNTING=t.PIECE_FLAG_UPGRADE=t.PIECE_FLAG_JUMP=t.PIECE_FLAG_KILL=t.NOT_SET=t.DEFAULT_BOARD_STR=t.STRING_COUNT=void 0,t.STRING_COUNT="B2F8G2H2K1Q1b2f8g2h2k1q1",t.DEFAULT_BOARD_STR="BHGKQGHB/8/FFFFFFFF/8/8/ffffffff/8/bhgqkghb",t.NOT_SET="-",t.PIECE_FLAG_KILL="x",t.PIECE_FLAG_JUMP="j",t.PIECE_FLAG_UPGRADE="u",t.PIECE_FLAG_START_COUNTING="z",t.EVENT_FLAG_ATTACK="attack",t.EVENT_FLAG_WIN="win",t.EVENT_FLAG_DRAW="draw",t.EVENT_FLAG_START_COUNTING="start-counting",t.EVENT_FLAG_COUNTING_DOWN="counting-down",t.EVENT_FLAG_COUNT_DOWN_OUT="count-down-out"},362:function(e,t,n){var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),r=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||i(t,e,n)},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Point=t.REN=t.PieceIndex=t.Piece=t.KqJumped=t.KAttacked=t.Graveyard=t.CountDown=t.Board=void 0;var u=n(191);Object.defineProperty(t,"Board",{enumerable:!0,get:function(){return o(u).default}});var a=n(177);Object.defineProperty(t,"CountDown",{enumerable:!0,get:function(){return o(a).default}});var s=n(717);Object.defineProperty(t,"Graveyard",{enumerable:!0,get:function(){return o(s).default}});var c=n(999);Object.defineProperty(t,"KAttacked",{enumerable:!0,get:function(){return o(c).default}});var l=n(832);Object.defineProperty(t,"KqJumped",{enumerable:!0,get:function(){return o(l).default}});var f=n(863);Object.defineProperty(t,"Piece",{enumerable:!0,get:function(){return o(f).default}});var p=n(568);Object.defineProperty(t,"PieceIndex",{enumerable:!0,get:function(){return o(p).default}});var h=n(19);Object.defineProperty(t,"REN",{enumerable:!0,get:function(){return o(h).default}});var d=n(135);Object.defineProperty(t,"Point",{enumerable:!0,get:function(){return o(d).default}}),r(n(72),t)},876:e=>{e.exports=JSON.parse('{"name":"khmer-chess","version":"1.0.47","description":"KhmerChess Javascript library","main":"src/index.ts","scripts":{"start":"ts-node test-index.ts","lint":"eslint . --ext .ts ./src","build:bundle":"webpack --config webpack.config.js","build:js":"del-cli dist -f && npm run lint && npx tsc","build":"npm run build:js && npm run build:bundle","test":"karma start karma.conf.js","cov":"http-server coverage/ -o"},"repository":{"type":"git","url":"git+https://github.com/K4us/khmer-chess.js.git"},"keywords":["KhmerChess","Khmer","Chess","Node.js","Library"],"author":"Raksa Eng <eng.raksa@gmail.com>","license":"MIT","bugs":{"url":"https://github.com/K4us/khmer-chess.js/issues"},"homepage":"https://github.com/K4us/khmer-chess.js#readme","devDependencies":{"@types/jasmine":"^3.8.2","@typescript-eslint/eslint-plugin":"^4.15.1","@typescript-eslint/parser":"^4.15.1","del-cli":"^4.0.1","eslint":"^7.20.0","http-server":"^13.0.1","karma":"^6.3.4","karma-chrome-launcher":"^3.1.0","karma-jasmine":"^4.0.1","karma-typescript":"^5.5.2","ts-loader":"^9.2.5","ts-node":"^9.1.1","typescript":"^4.3.5","webpack":"^5.21.2","webpack-cli":"^4.5.0"}}')}},t={};return function n(i){var r=t[i];if(void 0!==r)return r.exports;var o=t[i]={exports:{}};return e[i].call(o.exports,o,o.exports,n),o.exports}(303)})()}));
//# sourceMappingURL=khmer-chess.umd.js.map