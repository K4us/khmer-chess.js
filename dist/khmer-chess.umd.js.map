{"version":3,"file":"khmer-chess.umd.js","mappings":"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","sources":["webpack:///webpack/universalModuleDefinition","webpack:///./KhmerChess.ts","webpack:///./brain/HVPont.ts","webpack:///./brain/MoveHelper.ts","webpack:///./brain/Rectangle.ts","webpack:///./brain/boardEventController.ts","webpack:///./brain/boardHelper.ts","webpack:///./brain/constant.ts","webpack:///./brain/genMask.ts","webpack:///./brain/index.ts","webpack:///./brain/jsis.ts","webpack:///./index.ts","webpack:///./kpgn/Captured.ts","webpack:///./kpgn/KPGN.ts","webpack:///./kpgn/Move.ts","webpack:///./kpgn/Player.ts","webpack:///./kpgn/Result.ts","webpack:///./kpgn/Timer.ts","webpack:///./kpgn/index.ts","webpack:///./other/BoardEventController.ts","webpack:///./other/EventHandler.ts","webpack:///./other/index.ts","webpack:///./other/table.ts","webpack:///./ren/Board.ts","webpack:///./ren/CountDown.ts","webpack:///./ren/Graveyard.ts","webpack:///./ren/KAttacked.ts","webpack:///./ren/KqMoved.ts","webpack:///./ren/Piece.ts","webpack:///./ren/PieceIndex.ts","webpack:///./ren/Point.ts","webpack:///./ren/REN.ts","webpack:///./ren/constant.ts","webpack:///./ren/index.ts","webpack:///webpack/bootstrap","webpack:///webpack/startup"],"sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse {\n\t\tvar a = factory();\n\t\tfor(var i in a) (typeof exports === 'object' ? exports : root)[i] = a[i];\n\t}\n})(self, function() {\nreturn ","import config from '../package.json';\nimport { jsis } from './brain';\nimport KPGN from './kpgn/KPGN';\nimport Move from './kpgn/Move';\nimport BoardEventController, { BoardEvent } from './other/BoardEventController';\nimport { ListenerType } from './other/EventHandler';\nimport asciiTable from './other/table';\nimport { PieceIndex } from './ren';\nimport { EVENT_FLAG_ATTACK, EVENT_FLAG_WINN as EVENT_FLAG_WIN } from './ren/constant';\nimport Point from './ren/Point';\nimport REN from './ren/REN';\n\nexport default class KhmerChess {\n    static title = config.name;\n    static version = config.version;\n    kpgn: KPGN;\n    boardEventController: BoardEventController;\n    constructor(renStr?: string) {\n        const ren = REN.fromString(renStr);\n        this.kpgn = new KPGN(ren);\n        this.boardEventController = new BoardEventController();\n    }\n\n    loadRENStr(renStr?: string) {\n        this.kpgn.ren = REN.fromString(renStr);\n    }\n\n    loadMovesStrings(moves: string[]) {\n        let graveyardLastIndex = 0;\n        this.kpgn.moves = moves.map((move) => {\n            const moved = Move.fromMovedString(move, graveyardLastIndex);\n            if (moved.captured) {\n                graveyardLastIndex = moved.captured.toGraveyardPoint.index + 1;\n            }\n            return moved;\n        });\n    }\n\n    resetBoard() {\n        this.kpgn.ren = REN.fromString();\n    }\n\n    getCanMoves(): PieceIndex[] {\n        const pieceIndices = this.kpgn.ren.genAllCanMoves();\n        return pieceIndices;\n    }\n    getCanMovePointsByPoint(point: Point): Point[] {\n        const canMovePoints = this.kpgn.ren.getCanMovePointsByPoint(point);\n        return canMovePoints;\n    }\n\n    getAttacker(): PieceIndex | null {\n        return this.kpgn.ren.getAttacker();\n    }\n\n    getWinColor(): string | null {\n        return this.kpgn.ren.getWinColor();\n    }\n\n    getStuckColor(): string | null {\n        // TODO:\n        return null;\n    }\n\n    isDraw() {\n        return this.getStuckColor() || this.getDrawCountColor();\n    }\n\n    getDrawCountColor(): string | null {\n        // TODO:\n        return null;\n    }\n\n    gameOver() {\n        return this.getWinColor() || this.isDraw();\n    }\n\n    validateRENStr(renStr: string) {\n        try {\n            REN.fromString(renStr);\n            return { valid: true, error_number: 0, error: 'No errors.' };\n        } catch (error) {\n            return { valid: false, error_number: 1, error: error.message };\n        }\n    }\n\n    getRENStr() {\n        return this.kpgn.ren.toString();\n    }\n\n    get piecesInBoardMultiArray() {\n        return this.kpgn.ren.board.piecesMultiArray;\n    }\n\n    get piecesInBoard() {\n        return this.kpgn.ren.board.pieces;\n    }\n\n    get piecesInGraveyard() {\n        return this.kpgn.ren.graveyard.pieces;\n    }\n\n    // Khmer Portable Game Notation <file-name>.kpgn.json\n    getKPGN() {\n        return this.kpgn.toJson();\n    }\n\n    loadKpgn(kpgnJosn: any, options: any) {\n        this.kpgn = new KPGN(this.kpgn.ren);\n    }\n\n    drawAscii() {\n        return asciiTable(this.kpgn.ren);\n    }\n\n    get turn() {\n        return this.kpgn.ren.turn;\n    }\n\n    set turn(turn: string) {\n        this.kpgn.ren.turn = turn;\n    }\n\n    move(moveFromIndex: number, moveToIndex: number): Move | null {\n        const move = this.kpgn.ren.move(moveFromIndex, moveToIndex);\n        this.kpgn.moves.push(move);\n        return move;\n    }\n\n    undoMove() {\n        // TODO:\n        return false;\n    }\n\n    /**\n     * Move all pieces to graveyard except kings\n     * -> 4k3/8/8/8/8/8/8/3K4 w ---- -- -.- bhgqghbffffffffFFFFFFFFBHGQGHB\n     */\n    clearBoard() {\n        this.kpgn.ren = REN.fromString('4k3/8/8/8/8/8/8/3K4 w ---- -- -.- bhgqghbffffffffFFFFFFFFBHGQGHB');\n    }\n\n    getHistories() {\n        return this.kpgn.moves;\n    }\n\n    checkBoardEvent() {\n        const pieceIndex = this.getAttacker();\n        if (!jsis.isNull(pieceIndex)) {\n            const boardEvent = new BoardEvent({\n                flag: EVENT_FLAG_ATTACK,\n                actorPieceIndex: pieceIndex,\n            });\n            this.boardEventController.fireEvent(boardEvent);\n        }\n        const winColor = this.getWinColor();\n        if (!jsis.isNull(winColor)) {\n            const boardEvent = new BoardEvent({\n                flag: EVENT_FLAG_WIN,\n                actorPieceIndex: pieceIndex,\n            });\n            this.boardEventController.fireEvent(boardEvent);\n        }\n    }\n    addBoardEventListener(listener: ListenerType<BoardEvent>) {\n        this.boardEventController.addBoardEventListener(listener);\n    }\n    removeBoardEventListener(listener: ListenerType<BoardEvent>) {\n        this.boardEventController.removeBoardEventListener(listener);\n    }\n}\n/*\n * Copyright (c) 2021, K4us\n * Author: Raksa Eng <eng.raksa@gmail.com>\n * All rights reserved.\n *\n * Redistribution and use in source and binary forms, with or without\n * modification, are permitted provided that the following conditions are met:\n *\n * 1. Redistributions of source code must retain the above copyright notice,\n *    this list of conditions and the following disclaimer.\n * 2. Redistributions in binary form must reproduce the above copyright notice,\n *    this list of conditions and the following disclaimer in the documentation\n *    and/or other materials provided with the distribution.\n *\n * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS 'AS IS'\n * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE\n * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE\n * ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE\n * LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n * CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF\n * SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS\n * INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN\n * CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)\n * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE\n * POSSIBILITY OF SUCH DAMAGE.\n *\n *---------------------------------------------------------------------------- */","import { HORIZONTAL_CODE_LETTERS } from './constant';\nimport jsis from './jsis';\n\nexport default class HVPont {\n    h: string;\n    v: number;\n    get x() {\n        return HORIZONTAL_CODE_LETTERS.indexOf(this.h);\n    }\n    get y() {\n        return this.v - 1;\n    }\n    get indexCode() {\n        return `${this.h}${this.v}`;\n    }\n    constructor(h: string, v?: string | number) {\n        if (jsis.isUndefined(v)) {\n            h = h[0];\n            v = h[1];\n        }\n        this.h = h;\n        this.v = Number(v);\n    }\n\n}\n/*\n * Copyright (c) 2021, K4us\n * Author: Raksa Eng <eng.raksa@gmail.com>\n * All rights reserved.\n *\n * Redistribution and use in source and binary forms, with or without\n * modification, are permitted provided that the following conditions are met:\n *\n * 1. Redistributions of source code must retain the above copyright notice,\n *    this list of conditions and the following disclaimer.\n * 2. Redistributions in binary form must reproduce the above copyright notice,\n *    this list of conditions and the following disclaimer in the documentation\n *    and/or other materials provided with the distribution.\n *\n * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS 'AS IS'\n * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE\n * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE\n * ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE\n * LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n * CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF\n * SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS\n * INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN\n * CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)\n * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE\n * POSSIBILITY OF SUCH DAMAGE.\n *\n *---------------------------------------------------------------------------- */","import Piece from '../ren/Piece';\nimport PieceIndex from '../ren/PieceIndex';\nimport Point from '../ren/Point';\nimport boardHelper from './boardHelper';\nimport { PIECE_COLOR_BLACK, PIECE_COLOR_WHITE } from './constant';\n// abcdecbaooooooooffffffffoooooooooooooooommmmmmmmoooooooohijlkjih\nexport type OptionsType = {\n    piecesString: string;\n    currentTurn: string;\n    isQueenMoved: boolean;\n    isKingMoved: boolean;\n    genCanMove: boolean;\n    genCanMoveForAnother: boolean;\n};\nexport type CalCountPropsType = {\n    piecesString: string;\n    force: boolean;\n};\nexport default class MoveHelper implements OptionsType {\n    piecesString: string;\n    currentTurn: string;\n    isQueenMoved: boolean;\n    isKingMoved: boolean;\n    genCanMove: boolean;\n    genCanMoveForAnother: boolean;\n\n    whiteMoves: PieceIndex[];\n    blackMoves: PieceIndex[];\n    whiteKingInDanger: Point[] | null;\n    whiteKingWillInDanger: Point[] | null;\n    blackKingInDanger: Point[] | null;\n    blackKingWillInDanger: Point[] | null;\n    winColor: string | null;\n    stuckColor: string | null;\n\n    get isWhiteTurn() {\n        return Piece.isWhiteColor(this.currentTurn);\n    }\n    init(option: OptionsType) {\n        this.piecesString = option.piecesString;\n        this.currentTurn = option.currentTurn;\n        this.isQueenMoved = option.isQueenMoved;\n        this.isKingMoved = option.isKingMoved;\n\n        this.genCanMove = option.genCanMove;\n        this.genCanMoveForAnother = option.genCanMoveForAnother;\n\n        this.whiteMoves = [];\n        this.blackMoves = [];\n\n        this.whiteKingInDanger = null;\n        this.whiteKingWillInDanger = null;\n        this.blackKingInDanger = null;\n        this.blackKingWillInDanger = null;\n\n        this.winColor = null;\n        this.stuckColor = null;\n    }\n\n    generateCanMoves() {\n        const filter = boardHelper.filterPieceInBoard(this.piecesString);\n        this.whiteMoves = filter.whitePieces;\n        this.blackMoves = filter.blackPieces;\n        const genMoves = (pieceIndices: PieceIndex[]) => {\n            pieceIndices.forEach((pieceIndex) => {\n                let isHaveMoved = this.isKingMoved;\n                if (!pieceIndex.piece.isTypeKing) {\n                    isHaveMoved = pieceIndex.piece.isTypeQueen ? this.isQueenMoved : false;\n                }\n                const canMovePoints = this.genCanMovePointsByPiecePoint(\n                    pieceIndex.point,\n                    pieceIndex.piece,\n                    this.piecesString,\n                    isHaveMoved\n                );\n                pieceIndex.canMovePoints = canMovePoints;\n            });\n        };\n        genMoves(this.whiteMoves);\n        genMoves(this.blackMoves);\n    }\n\n    cleanPieceNoMove() {\n        const cleanMoves = (pieces: any[]) => {\n            let isTrue = true;\n            while (isTrue) {\n                isTrue = false;\n                for (let i = 0; i < pieces.length; i++) {\n                    const piece = pieces[i];\n                    if (!piece.canMovePoints.length) {\n                        pieces.splice(i, 1);\n                        isTrue = true;\n                        break;\n                    }\n                }\n            }\n        };\n        cleanMoves(this.whiteMoves);\n        cleanMoves(this.blackMoves);\n    }\n\n    checkIfKingInDanger() {\n        this.whiteKingInDanger = boardHelper.getKingInDanger(\n            PIECE_COLOR_WHITE,\n            this.piecesString\n        );\n        this.whiteKingWillInDanger = boardHelper.getKingWillInDanger(\n            PIECE_COLOR_WHITE,\n            this.piecesString\n        );\n        this.blackKingInDanger = boardHelper.getKingInDanger(\n            PIECE_COLOR_BLACK,\n            this.piecesString\n        );\n        this.blackKingWillInDanger = boardHelper.getKingWillInDanger(\n            PIECE_COLOR_BLACK,\n            this.piecesString\n        );\n    }\n\n    genWinLost() {\n        if (this.whiteKingInDanger && !this.whiteMoves.length) {\n            this.winColor = PIECE_COLOR_BLACK;\n        } else if (this.blackKingInDanger && !this.blackMoves.length) {\n            this.winColor = PIECE_COLOR_WHITE;\n        }\n    }\n\n    getStuck() {\n        if (this.winColor) {\n            return;\n        }\n        if (this.isWhiteTurn && !this.whiteMoves.length) {\n            this.stuckColor = PIECE_COLOR_WHITE;\n        } else if (!this.isWhiteTurn && !this.blackMoves.length) {\n            this.stuckColor = PIECE_COLOR_BLACK;\n        }\n    }\n\n    calcCanMove(option: OptionsType) {\n        this.init(option);\n        this.generateCanMoves();\n        this.cleanPieceNoMove();\n        let moves: PieceIndex[] = [];\n        if (this.genCanMove) {\n            moves = this.isWhiteTurn ? this.whiteMoves : this.blackMoves;\n        }\n        let anotherMoves: PieceIndex[] = [];\n        if (this.genCanMoveForAnother) {\n            anotherMoves = !this.isWhiteTurn ? this.whiteMoves : this.blackMoves;\n        }\n        return {\n            moves,\n            anotherMoves,\n        };\n    }\n\n    calcState(option: OptionsType) {\n        this.init(option);\n        this.generateCanMoves();\n        this.cleanPieceNoMove();\n\n        this.checkIfKingInDanger();\n        this.genWinLost();\n        this.getStuck();\n        return {\n            blackKingInDanger: this.blackKingInDanger,\n            whiteKingInDanger: this.whiteKingInDanger,\n            blackKingWillInDanger: this.blackKingWillInDanger,\n            whiteKingWillInDanger: this.whiteKingWillInDanger,\n            winColor: this.winColor,\n            stuckColor: this.stuckColor,\n            blackCountable: boardHelper.checkCountable(\n                PIECE_COLOR_BLACK,\n                this.piecesString\n            ),\n            whiteCountable: boardHelper.checkCountable(\n                PIECE_COLOR_WHITE,\n                this.piecesString\n            ),\n        };\n    }\n\n    calCount(option: CalCountPropsType) {\n        return {\n            countingBlack: boardHelper.checkCount(\n                PIECE_COLOR_BLACK,\n                option.piecesString, option.force\n            ),\n            countingWhite: boardHelper.checkCount(\n                PIECE_COLOR_WHITE,\n                option.piecesString, option.force\n            ),\n        };\n    }\n\n    genCanMovePointsByPiecePoint(point: Point, piece: Piece,\n        piecesString: string, isHasMoved?: boolean) {\n        return boardHelper.genCanMovePointsByPiecePoint(\n            point.index,\n            piece,\n            piecesString,\n            isHasMoved\n        );\n    }\n}\n/*\n * Copyright (c) 2021, K4us\n * Author: Raksa Eng <eng.raksa@gmail.com>\n * All rights reserved.\n *\n * Redistribution and use in source and binary forms, with or without\n * modification, are permitted provided that the following conditions are met:\n *\n * 1. Redistributions of source code must retain the above copyright notice,\n *    this list of conditions and the following disclaimer.\n * 2. Redistributions in binary form must reproduce the above copyright notice,\n *    this list of conditions and the following disclaimer in the documentation\n *    and/or other materials provided with the distribution.\n *\n * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS 'AS IS'\n * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE\n * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE\n * ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE\n * LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n * CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF\n * SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS\n * INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN\n * CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)\n * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE\n * POSSIBILITY OF SUCH DAMAGE.\n *\n *---------------------------------------------------------------------------- */","import { Point } from '../ren';\nimport { ROW_LAST_INDEX } from './constant';\n\nexport default class Rectangle {\n    x: number;\n    y: number;\n    width: number;\n    height: number;\n    constructor(x: number, y: number, width: number, height: number) {\n        this.x = x;\n        this.y = y;\n        this.width = width;\n        this.height = height;\n    }\n\n    isContainsPoint(point: Point) {\n        const { x, y } = point;\n        const isContainsPoint = this.x <= x &&\n            (this.x + this.width) >= x &&\n            this.y <= y &&\n            (this.y + this.height) >= y;\n        return isContainsPoint;\n    }\n\n    static isValidPoint(point: Point) {\n        return new Rectangle(0, 0, ROW_LAST_INDEX, ROW_LAST_INDEX).isContainsPoint(point);\n    }\n}\n/*\n * Copyright (c) 2021, K4us\n * Author: Raksa Eng <eng.raksa@gmail.com>\n * All rights reserved.\n *\n * Redistribution and use in source and binary forms, with or without\n * modification, are permitted provided that the following conditions are met:\n *\n * 1. Redistributions of source code must retain the above copyright notice,\n *    this list of conditions and the following disclaimer.\n * 2. Redistributions in binary form must reproduce the above copyright notice,\n *    this list of conditions and the following disclaimer in the documentation\n *    and/or other materials provided with the distribution.\n *\n * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS 'AS IS'\n * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE\n * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE\n * ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE\n * LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n * CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF\n * SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS\n * INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN\n * CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)\n * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE\n * POSSIBILITY OF SUCH DAMAGE.\n *\n *---------------------------------------------------------------------------- */","import EventHandler from '../other/EventHandler';\r\n\r\nconst TRIGGER_MOVE = 'trigger-move';\r\n\r\nexport default class BoardEventController extends EventHandler {\r\n    constructor() {\r\n        super({\r\n            events: {\r\n                TRIGGER_MOVE,\r\n            },\r\n        });\r\n    }\r\n\r\n    removeOnTriggerMoveEventListener(listener: any) {\r\n        this._removeOnEventListener(TRIGGER_MOVE, listener);\r\n    }\r\n\r\n    addOnTriggerMoveEventListener(listener: any) {\r\n        this._addOnEventListener(TRIGGER_MOVE, listener);\r\n    }\r\n}\r\n/*\r\n * Copyright (c) 2021, K4us\r\n * Author: Raksa Eng <eng.raksa@gmail.com>\r\n * All rights reserved.\r\n *\r\n * Redistribution and use in source and binary forms, with or without\r\n * modification, are permitted provided that the following conditions are met:\r\n *\r\n * 1. Redistributions of source code must retain the above copyright notice,\r\n *    this list of conditions and the following disclaimer.\r\n * 2. Redistributions in binary form must reproduce the above copyright notice,\r\n *    this list of conditions and the following disclaimer in the documentation\r\n *    and/or other materials provided with the distribution.\r\n *\r\n * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS 'AS IS'\r\n * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE\r\n * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE\r\n * ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE\r\n * LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\r\n * CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF\r\n * SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS\r\n * INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN\r\n * CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)\r\n * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE\r\n * POSSIBILITY OF SUCH DAMAGE.\r\n *\r\n *---------------------------------------------------------------------------- */","import jsis from './jsis';\nimport genMask from './genMask';\nimport {\n    PIECE_COLOR_WHITE,\n    PIECE_COLOR_BLACK,\n    EMPTY_PIECE,\n    ROW_NUMBER,\n    PIECE_TYPE_FISH,\n    PIECE_TYPE_BOAT,\n    PIECE_TYPE_GENERAL,\n    PIECE_TYPE_HORSE,\n    PIECE_TYPE_KING,\n    CELL_COUNT,\n} from './constant';\nimport Point from '../ren/Point';\nimport Piece from '../ren/Piece';\nimport Rectangle from './Rectangle';\nimport { PieceIndex } from '../ren';\n\nconst mask = genMask();\n\nclass BoardHelper {\n    getCharPieceFromString(piecesString: string, index: number) {\n        if (Point.isIndexInBoard(index) && piecesString.length === CELL_COUNT) {\n            return piecesString[index];\n        }\n        return EMPTY_PIECE;\n    }\n    getCharPieceInPos(index: number, piecesString: string) {\n        return this.getCharPieceFromString(piecesString, index);\n    }\n    getPieceByIndex(index: number, piecesString: string): {\n        isValidPiece: boolean, piece: Piece | null\n    } {\n        const charCode = this.getCharPieceInPos(index, piecesString);\n        return {\n            isValidPiece: Piece.isValidPiece(charCode),\n            piece: Piece.fromCharCode(charCode),\n        };\n    }\n    convertMask = (point1: Point, index: number, color: string) => {\n        const sign = Piece.isWhiteColor(color) ? 1 : -1;\n        const point2 = Point.fromIndex(index);\n        point1.x = point1.x * sign + point2.x;\n        point1.y = point1.y * sign + point2.y;\n        return Rectangle.isValidPoint(point1) ? point1.index : null;\n    };\n    getPieceCanMovePoses(index: number, piece: Piece) {\n        const pieceIndices: number[] = [];\n        mask[piece.type].forEach((_pos: number[]) => {\n            const newIndex = this.convertMask(new Point(_pos[0], _pos[1]), index, piece.color);\n            if (!jsis.isNull(newIndex)) {\n                pieceIndices.push(newIndex);\n            }\n        });\n        return pieceIndices;\n    }\n    getPieceCanMovePosesValid(index: number, piece: Piece, piecesString: string) {\n        const _poses = this.getPieceCanMovePoses(index, piece);\n        const pieceIndices = [];\n        const n = _poses.length;\n        const thisPos = Point.fromIndex(index);\n        for (let i = 0; i < n; i++) {\n            let p = Point.fromIndex(_poses[i]);\n            const distPiece = this.getPieceByIndex(p.index, piecesString);\n            if (distPiece.isValidPiece) {\n                if (piece.color === distPiece.piece.color ||\n                    (piece.isTypeFish && p.x === thisPos.x)) {\n                    p = null;\n                }\n            } else {\n                if (piece.isTypeFish && p.x !== thisPos.x) {\n                    p = null;\n                }\n            }\n            if (!jsis.isNull(p) && piece.isTypeBoat) {\n                const _x = thisPos.x;\n                const _y = thisPos.y;\n                if (p.x === thisPos.x) {\n                    let _n = Math.abs(p.y - thisPos.y);\n                    const _s = thisPos.y < p.y ? 1 : -1;\n                    while (--_n > 0) {\n                        if (this.getPieceByIndex(Point.xyToIndex(_x, _y + _s * _n), piecesString).isValidPiece) {\n                            p = null;\n                            break;\n                        }\n                    }\n                } else if (p.y === thisPos.y) {\n                    let _n = Math.abs(p.x - thisPos.x);\n                    const _s = thisPos.x < p.x ? 1 : -1;\n                    while (--_n > 0) {\n                        if (this.getPieceByIndex(Point.xyToIndex(_x + _s * _n, _y), piecesString).isValidPiece) {\n                            p = null;\n                            break;\n                        }\n                    }\n                }\n            }\n            if (!jsis.isNull(p)) {\n                pieceIndices.push(_poses[i]);\n            }\n        }\n        return pieceIndices;\n    }\n    replacePiecesStringAtIndex(piecesString: string, charCode: string, index: number) {\n        return piecesString.substring(0, index) + charCode + piecesString.substring(index + 1);\n    }\n    injectPiece(piecesString: string, index1: number, index2: number) {\n        const c = piecesString[index1];\n        if (!this.isCharPiecesInBoard(c, piecesString)) {\n            return null;\n        }\n        piecesString = this.replacePiecesStringAtIndex(piecesString, EMPTY_PIECE, index1);\n        piecesString = this.replacePiecesStringAtIndex(piecesString, c, index2);\n        return piecesString;\n    }\n    getKingWillInDanger(color: string, piecesString: string) {\n        const kingPos = piecesString.indexOf(new Piece(PIECE_TYPE_KING, color).pieceCharCode);\n        const n = piecesString.length;\n        for (let i = 0; i < n; i++) {\n            const p = this.getPieceByIndex(i, piecesString);\n            if (p.isValidPiece && p.piece.color !== color &&\n                p.piece.isTypeBoat) {\n                const _poses = this.getPieceCanMovePoses(i, p.piece);\n                for (let j = 0; j < _poses.length; j++) {\n                    if (_poses[j] === kingPos) {\n                        return [Point.fromIndex(i), Point.fromIndex(kingPos)];\n                    }\n                }\n            }\n        }\n        return null;\n    }\n    getKingInDanger(color: string, piecesString: string): Point[] | null {\n        const kingPos = piecesString.indexOf(new Piece(PIECE_TYPE_KING, color).pieceCharCode);\n        const n = piecesString.length;\n        for (let i = 0; i < n; i++) {\n            const p = this.getPieceByIndex(i, piecesString);\n            if (p.isValidPiece && p.piece.color !== color) {\n                const _poses = this.getPieceCanMovePosesValid(i, p.piece, piecesString);\n                for (let j = 0; j < _poses.length; j++) {\n                    if (_poses[j] === kingPos) {\n                        return [Point.fromIndex(i), Point.fromIndex(kingPos)];\n                    }\n                }\n            }\n        }\n        return null;\n    }\n    genCanMovePointsByPiecePoint(index: number, piece: Piece,\n        piecesString: string, isHasMoved?: boolean) {\n        const _poses = this.getPieceCanMovePosesValid(index, piece, piecesString);\n        const isHaveCaptured = this.isHaveCaptured(piecesString);\n        if (piece.isTypeKing) {\n            if (!isHaveCaptured && !isHasMoved) {\n                let p = this.convertMask(new Point(2, 1), index, piece.color);\n                if (p && !this.getPieceByIndex(p, piecesString).isValidPiece) {\n                    _poses.push(p);\n                }\n                p = this.convertMask(new Point(-2, 1), index, piece.color);\n                if (p && !this.getPieceByIndex(p, piecesString).isValidPiece) {\n                    _poses.push(p);\n                }\n            }\n        } else if (piece.isTypeQueen) {\n            if (!isHaveCaptured && !isHasMoved) {\n                const p = this.convertMask(new Point(-0, 2), index, piece.color);\n                if (p && !this.getPieceByIndex(p, piecesString).isValidPiece) {\n                    _poses.push(p);\n                }\n            }\n        }\n        const n = _poses.length;\n        const points: Point[] = [];\n        for (let i = 0; i < n; i++) {\n            const str = this.injectPiece(piecesString, index, _poses[i]);\n            if (jsis.isNull(this.getKingInDanger(piece.color, str))) {\n                points.push(Point.fromIndex(_poses[i]));\n            }\n        }\n        return points;\n    }\n    isCharPiecesInBoard(code: string, piecesString: string) {\n        return !!~piecesString.indexOf(code);\n    }\n    getPiecesInBoard(piecesString: string) {\n        return piecesString.split('').filter((charCode: string) => {\n            return Piece.isValidPiece(charCode);\n        });\n    }\n    isHaveCaptured(piecesString: string) {\n        return this.getPiecesInBoard(piecesString).length < ROW_NUMBER * 4;\n    }\n    filterPieceInBoard(piecesString: string) {\n        const whitePieces: PieceIndex[] = [];\n        const blackPieces: PieceIndex[] = [];\n        for (let i = 0; i < piecesString.length; i++) {\n            const charCode = piecesString[i];\n            if (Piece.isValidPiece(charCode)) {\n                const pieceIndex = new PieceIndex(Point.fromIndex(i), Piece.fromCharCode(charCode));\n                if (pieceIndex.piece.isColorWhite) {\n                    whitePieces.push(pieceIndex);\n                } else {\n                    blackPieces.push(pieceIndex);\n                }\n            }\n        }\n        return {\n            whitePieces,\n            blackPieces,\n        };\n    }\n    extractPiecesToArray(piecesString: string) {\n        const piecesStringArr = piecesString.split('');\n        const pieceAll: { [key: string]: string[] } = {\n            [PIECE_COLOR_BLACK]: [],\n            [PIECE_COLOR_WHITE]: [],\n        };\n        piecesStringArr.forEach((charCode: string) => {\n            if (charCode === EMPTY_PIECE) {\n                return;\n            }\n            const piece = Piece.fromCharCode(charCode);\n            pieceAll[piece.color].push(piece.type);\n        });\n        return pieceAll;\n    }\n    isStateCount(c: string, piecesString: string) {\n        const allPieces = this.extractPiecesToArray(piecesString);\n        return allPieces[c].length === 1;\n    }\n    checkCountable(color: string, piecesString: string) {\n        const pieceAll = this.extractPiecesToArray(piecesString);\n        const weaker = pieceAll[color];\n        const stronger = pieceAll[Piece.oppositeColor(color)];\n        return weaker.length <= 2 && stronger.length >= 2;\n    }\n    checkCount(color: string, piecesString: string, force: boolean) {\n        const countChar = (str: string[], c: string) => {\n            return str.join('').split(c).length - 1;\n        };\n        const charExist = (str: string[], c: string) => {\n            return !!~str.indexOf(c);\n        };\n\n        const pieceAll = this.extractPiecesToArray(piecesString);\n        const weaker = pieceAll[color];\n        const stronger = pieceAll[Piece.oppositeColor(color)];\n        if (weaker.length === 1 && stronger.length > 1) {\n            if (!charExist(stronger, PIECE_TYPE_FISH)) {\n                let count = 64;\n                const toukCount = countChar(stronger, PIECE_TYPE_BOAT);\n                if (toukCount) {\n                    count = toukCount > 1 ? 8 : 16;\n                } else if (countChar(stronger, PIECE_TYPE_GENERAL) > 1) {\n                    count = 22;\n                } else if (countChar(stronger, PIECE_TYPE_HORSE) > 1) {\n                    count = 32;\n                } else if (countChar(stronger, PIECE_TYPE_GENERAL)) {\n                    count = 44;\n                }\n                return [stronger.length + 1, count];\n            }\n            return [0, 64];\n        } else if (force && this.checkCountable(color, piecesString)) {\n            return [0, 64];\n        }\n        return null;\n    }\n    isUpgradable(piece: Piece, point: Point) {\n        if (piece.isTypeFish) {\n            if (piece.isColorBlack && point.y <= 2) {\n                return true;\n            }\n            if (piece.isColorWhite && point.y >= 5) {\n                return true;\n            }\n        }\n        return false;\n    }\n};\n\nexport default new BoardHelper();\n/*\n * Copyright (c) 2021, K4us\n * Author: Raksa Eng <eng.raksa@gmail.com>\n * All rights reserved.\n *\n * Redistribution and use in source and binary forms, with or without\n * modification, are permitted provided that the following conditions are met:\n *\n * 1. Redistributions of source code must retain the above copyright notice,\n *    this list of conditions and the following disclaimer.\n * 2. Redistributions in binary form must reproduce the above copyright notice,\n *    this list of conditions and the following disclaimer in the documentation\n *    and/or other materials provided with the distribution.\n *\n * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS 'AS IS'\n * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE\n * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE\n * ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE\n * LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n * CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF\n * SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS\n * INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN\n * CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)\n * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE\n * POSSIBILITY OF SUCH DAMAGE.\n *\n *---------------------------------------------------------------------------- */","export const PIECE_COLOR_WHITE = 'w';\nexport const PIECE_COLOR_BLACK = 'b';\nexport const COLOR_NAMES: { [key: string]: string } = {\n    [PIECE_COLOR_BLACK]: 'ខ្មៅ',\n    [PIECE_COLOR_WHITE]: 'ស',\n};\nexport const COLOR_NAMES_ENGLISH: { [key: string]: string } = {\n    [PIECE_COLOR_BLACK]: 'black',\n    [PIECE_COLOR_WHITE]: 'white',\n};\n\nexport const PIECE_TYPE_BOAT = 'b'; // Boat\nexport const PIECE_TYPE_HORSE = 'h'; // Horse\nexport const PIECE_TYPE_GENERAL = 'g'; // General\nexport const PIECE_TYPE_KING = 'k'; // King\nexport const PIECE_TYPE_QUEEN = 'q'; // Queen\nexport const PIECE_TYPE_FISH = 'f'; // Fish\nexport const PIECE_TYPE_TRANSFORM_FISH = 't'; // Transform fish\nexport const PIECE_NAMES: { [key: string]: string } = {\n    [PIECE_TYPE_BOAT]: 'ទូក',\n    [PIECE_TYPE_HORSE]: 'សេះ',\n    [PIECE_TYPE_GENERAL]: 'គោល',\n    [PIECE_TYPE_KING]: 'ស្តេច',\n    [PIECE_TYPE_QUEEN]: 'នាង',\n    [PIECE_TYPE_FISH]: 'ត្រី',\n    [PIECE_TYPE_TRANSFORM_FISH]: 'ត្រីបក',\n};\nexport const PIECE_NAMES_ENGLISH: { [key: string]: string } = {\n    [PIECE_TYPE_BOAT]: 'boat',\n    [PIECE_TYPE_HORSE]: 'horse',\n    [PIECE_TYPE_GENERAL]: 'general',\n    [PIECE_TYPE_KING]: 'king',\n    [PIECE_TYPE_QUEEN]: 'queen',\n    [PIECE_TYPE_FISH]: 'fish',\n    [PIECE_TYPE_TRANSFORM_FISH]: 'transformed-fish',\n};\nexport const EMPTY_PIECE = '.';\nexport const PIECE_COLOR_EMPTY = '.';\nexport const BOARD_SEPARATOR = '/';\n\nexport const ROW_NUMBER = 8;\nexport const ROW_FIRST_INDEX = 0;\nexport const ROW_LAST_INDEX = 7;\nexport const CELL_COUNT = ROW_NUMBER * ROW_NUMBER;\n\nexport const HORIZONTAL_CODE_LETTERS = 'abcdefgh';\nexport const HORIZONTAL_NOTE_LETTERS = ['ក', 'ខ', 'គ', 'ឃ', 'ង', 'ច', 'ឆ', 'ជ'];\nexport const VERTICAL_NOTE_LETTERS = ['១', '២', '៣', '៤', '៥', '៦', '៧', '៨', '៩', '១០',\n    '១១', '១២', '១៣', '១៤', '១៥', '១៦', '១៧', '១៨', '១៩', '២០',\n    '២១', '២២', '២៣', '២៤', '២៥', '២៦', '២៧', '២៨', '២៩', '៣០'];\nexport const HORIZONTAL_NOTE_LETTERS_ENGLISH = 'abcdefgh';\nexport const VERTICAL_NOTE_LETTERS_ENGLISH = Array.from({ length: 30 }, (_, i) => `${i + 1}`);\n/*\n * Copyright (c) 2021, K4us\n * Author: Raksa Eng <eng.raksa@gmail.com>\n * All rights reserved.\n *\n * Redistribution and use in source and binary forms, with or without\n * modification, are permitted provided that the following conditions are met:\n *\n * 1. Redistributions of source code must retain the above copyright notice,\n *    this list of conditions and the following disclaimer.\n * 2. Redistributions in binary form must reproduce the above copyright notice,\n *    this list of conditions and the following disclaimer in the documentation\n *    and/or other materials provided with the distribution.\n *\n * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS 'AS IS'\n * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE\n * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE\n * ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE\n * LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n * CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF\n * SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS\n * INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN\n * CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)\n * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE\n * POSSIBILITY OF SUCH DAMAGE.\n *\n *---------------------------------------------------------------------------- */","import {\n    PIECE_TYPE_BOAT,\n    PIECE_TYPE_HORSE,\n    PIECE_TYPE_KING,\n    PIECE_TYPE_GENERAL,\n    PIECE_TYPE_FISH,\n    PIECE_TYPE_TRANSFORM_FISH,\n    PIECE_TYPE_QUEEN,\n} from './constant';\n\nexport default function genMask() {\n    const mask: { [key: string]: number[][] } = {};\n    mask[PIECE_TYPE_BOAT] = [\n        [0, 1], [0, 2], [0, 3], [0, 4], [0, 5], [0, 6], [0, 7], [0, 8],\n        [0, -1], [0, -2], [0, -3], [0, -4], [0, -5], [0, -6], [0, -7], [0, -8],\n        [1, 0], [2, 0], [3, 0], [4, 0], [5, 0], [6, 0], [7, 0], [8, 0],\n        [-1, 0], [-2, 0], [-3, 0], [-4, 0], [-5, 0], [-6, 0], [-7, 0], [-8, 0],\n    ];\n    mask[PIECE_TYPE_HORSE] = [\n        [-1, -2],\n        [1, -2],\n        [-2, -1],\n        [2, -1],\n        [-1, 2],\n        [1, 2],\n        [-2, 1],\n        [2, 1],\n    ];\n    mask[PIECE_TYPE_QUEEN] = [\n        [-1, -1],\n        [1, -1],\n        [-1, 1],\n        [1, 1],\n    ];\n    mask[PIECE_TYPE_GENERAL] = mask[PIECE_TYPE_QUEEN].concat([\n        [0, 1],\n    ]);\n    mask[PIECE_TYPE_KING] = mask[PIECE_TYPE_GENERAL].concat([\n        [0, -1],\n        [1, 0],\n        [-1, 0],\n    ]);\n    mask[PIECE_TYPE_FISH] = [\n        [0, 1],\n        [-1, 1],\n        [1, 1],\n    ];\n    mask[PIECE_TYPE_TRANSFORM_FISH] = mask[PIECE_TYPE_QUEEN];\n    return mask;\n}\n/*\n * Copyright (c) 2021, K4us\n * Author: Raksa Eng <eng.raksa@gmail.com>\n * All rights reserved.\n *\n * Redistribution and use in source and binary forms, with or without\n * modification, are permitted provided that the following conditions are met:\n *\n * 1. Redistributions of source code must retain the above copyright notice,\n *    this list of conditions and the following disclaimer.\n * 2. Redistributions in binary form must reproduce the above copyright notice,\n *    this list of conditions and the following disclaimer in the documentation\n *    and/or other materials provided with the distribution.\n *\n * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS 'AS IS'\n * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE\n * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE\n * ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE\n * LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n * CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF\n * SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS\n * INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN\n * CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)\n * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE\n * POSSIBILITY OF SUCH DAMAGE.\n *\n *---------------------------------------------------------------------------- */","export { default as Rectangle } from './Rectangle';\nexport { default as boardEventController } from './boardEventController';\nexport { default as boardHelper } from './boardHelper';\nexport { default as genMask } from './genMask';\nexport { default as jsis } from './jsis';\nexport { default as HVPont } from './HVPont';\nexport { default as MoveHelper } from './MoveHelper';\nexport { OptionsType, CalCountPropsType } from './MoveHelper';\nexport * from './constant';\n/*\n * Copyright (c) 2021, K4us\n * Author: Raksa Eng <eng.raksa@gmail.com>\n * All rights reserved.\n *\n * Redistribution and use in source and binary forms, with or without\n * modification, are permitted provided that the following conditions are met:\n *\n * 1. Redistributions of source code must retain the above copyright notice,\n *    this list of conditions and the following disclaimer.\n * 2. Redistributions in binary form must reproduce the above copyright notice,\n *    this list of conditions and the following disclaimer in the documentation\n *    and/or other materials provided with the distribution.\n *\n * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS 'AS IS'\n * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE\n * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE\n * ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE\n * LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n * CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF\n * SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS\n * INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN\n * CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)\n * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE\n * POSSIBILITY OF SUCH DAMAGE.\n *\n *---------------------------------------------------------------------------- */","const jsis = {\n    isValid(v: any) {\n        return !this.isNull(v) && !this.isUndefined(v);\n    },\n    isNull(v: any) {\n        return v === null;\n    },\n    isUndefined(v: any) {\n        return typeof v === 'undefined';\n    },\n    isString(str: any) {\n        return this.isValid(str) && typeof str === 'string';\n    },\n    isNotEmpty(str: string) {\n        // eslint-disable-next-line eqeqeq\n        return this.isValidString(str) && str != '';\n    },\n    isNumber(n: any) {\n        return this.isValid(n) && typeof n === 'number';\n    },\n    isStringNumber(n: string) {\n        // eslint-disable-next-line eqeqeq\n        return this.isString(n) && n != '' && !isNaN(Number(n));\n    },\n    isArray(arr: any) {\n        return this.isValid(arr) && arr instanceof Array;\n    },\n    isFunction(f: any) {\n        return this.isValid(f) && typeof f === 'function';\n    },\n    isObject(o: any) {\n        return this.isValid(o) && o instanceof Object;\n    },\n    isBoolean(b: any) {\n        return this.isValid(b) && typeof b === 'boolean';\n    },\n    isTrue(b: any) {\n        return this.isValidBoolean(b) && b;\n    },\n    isFalse(b: any) {\n        return this.isValidBoolean(b) && !b;\n    },\n    isPoint(p: { x: any; y: any; }) {\n        const isPoint = this.isValid(p) &&\n            this.isValidObject(p) &&\n            this.isValidNumber(p.x) &&\n            this.isValidNumber(p.y);\n        return isPoint;\n    },\n    isSize(size: { width: any; height: any; }) {\n        const isSize = this.isValid(size) &&\n            this.isValidObject(size) &&\n            this.isValidNumber(size.width) &&\n            this.isValidNumber(size.height);\n        return isSize;\n    },\n    isOdd(n: number) {\n        return !!(n % 2);\n    },\n    isEven(n: any) {\n        return !this.isOdd(n);\n    },\n    isUpperCase(str: string) {\n        return str === str.toUpperCase();\n    },\n};\n\nexport default jsis;\n/*\n * Copyright (c) 2021, K4us\n * Author: Raksa Eng <eng.raksa@gmail.com>\n * All rights reserved.\n *\n * Redistribution and use in source and binary forms, with or without\n * modification, are permitted provided that the following conditions are met:\n *\n * 1. Redistributions of source code must retain the above copyright notice,\n *    this list of conditions and the following disclaimer.\n * 2. Redistributions in binary form must reproduce the above copyright notice,\n *    this list of conditions and the following disclaimer in the documentation\n *    and/or other materials provided with the distribution.\n *\n * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS 'AS IS'\n * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE\n * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE\n * ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE\n * LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n * CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF\n * SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS\n * INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN\n * CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)\n * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE\n * POSSIBILITY OF SUCH DAMAGE.\n *\n *---------------------------------------------------------------------------- */","export * from './brain';\nexport * from './kpgn';\nexport * from './ren';\nexport * from './other';\nexport { default as KhmerChess } from './KhmerChess';\n/*\n * Copyright (c) 2021, K4us\n * Author: Raksa Eng <eng.raksa@gmail.com>\n * All rights reserved.\n *\n * Redistribution and use in source and binary forms, with or without\n * modification, are permitted provided that the following conditions are met:\n *\n * 1. Redistributions of source code must retain the above copyright notice,\n *    this list of conditions and the following disclaimer.\n * 2. Redistributions in binary form must reproduce the above copyright notice,\n *    this list of conditions and the following disclaimer in the documentation\n *    and/or other materials provided with the distribution.\n *\n * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS 'AS IS'\n * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE\n * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE\n * ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE\n * LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n * CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF\n * SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS\n * INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN\n * CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)\n * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE\n * POSSIBILITY OF SUCH DAMAGE.\n *\n *---------------------------------------------------------------------------- */","\nimport Piece from '../ren/Piece';\nimport Point from '../ren/Point';\n\nexport type CapturedPropType = {\n    piece: Piece;\n    fromBoardPoint: Point;\n    toGraveyardPoint: Point;\n};\nexport default class Captured implements CapturedPropType {\n    piece: Piece;\n    fromBoardPoint: Point;\n    toGraveyardPoint: Point;\n    constructor({ piece, fromBoardPoint: fromBoardPoint, toGraveyardPoint: toGraveyardPoint }: CapturedPropType) {\n        this.piece = piece;\n        this.fromBoardPoint = fromBoardPoint;\n        this.toGraveyardPoint = toGraveyardPoint;\n    }\n}\n/*\n * Copyright (c) 2021, K4us\n * Author: Raksa Eng <eng.raksa@gmail.com>\n * All rights reserved.\n *\n * Redistribution and use in source and binary forms, with or without\n * modification, are permitted provided that the following conditions are met:\n *\n * 1. Redistributions of source code must retain the above copyright notice,\n *    this list of conditions and the following disclaimer.\n * 2. Redistributions in binary form must reproduce the above copyright notice,\n *    this list of conditions and the following disclaimer in the documentation\n *    and/or other materials provided with the distribution.\n *\n * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS 'AS IS'\n * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE\n * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE\n * ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE\n * LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n * CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF\n * SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS\n * INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN\n * CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)\n * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE\n * POSSIBILITY OF SUCH DAMAGE.\n *\n *---------------------------------------------------------------------------- */","import REN from '../ren/REN';\nimport Move from './Move';\nimport Player from './Player';\nimport Result from './Result';\nimport Timer from './Timer';\n\n// TODO: improve KPGN\nexport default class KPGN {\n    event: string = '';\n    date: string = '';\n    location: string = '';\n    players = {\n        white: new Player(),\n        black: new Player(),\n    };\n    result = {\n        last: {\n            whiteWin: false,\n            blackWin: false,\n        },\n        white: new Result(),\n    };\n\n    moves: Move[];\n    ren: REN;\n    timer: Timer = new Timer();\n\n    constructor(ren: REN) {\n        this.ren = ren;\n        this.moves = [];\n    }\n\n    toJson() {\n        return {\n            event: this.event,\n            date: this.date,\n            location: this.location,\n            players: {\n                white: this.players.white.toJson(),\n                black: this.players.black.toJson(),\n            },\n            result: {\n                last: {\n                    whiteWin: this.result.last.whiteWin,\n                    blackWin: this.result.last.blackWin,\n                },\n                white: this.result.white.toJson(),\n            },\n            moves: this.moves.map((m) => m.toJson()),\n            ren: this.ren.toString(),\n            timer: this.timer.toJson(),\n        };\n    }\n}\n/*\n * Copyright (c) 2021, K4us\n * Author: Raksa Eng <eng.raksa@gmail.com>\n * All rights reserved.\n *\n * Redistribution and use in source and binary forms, with or without\n * modification, are permitted provided that the following conditions are met:\n *\n * 1. Redistributions of source code must retain the above copyright notice,\n *    this list of conditions and the following disclaimer.\n * 2. Redistributions in binary form must reproduce the above copyright notice,\n *    this list of conditions and the following disclaimer in the documentation\n *    and/or other materials provided with the distribution.\n *\n * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS 'AS IS'\n * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE\n * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE\n * ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE\n * LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n * CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF\n * SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS\n * INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN\n * CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)\n * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE\n * POSSIBILITY OF SUCH DAMAGE.\n *\n *---------------------------------------------------------------------------- */","\nimport { boardHelper } from '../brain';\nimport {\n    PIECE_FLAG_JUMP,\n    PIECE_FLAG_KILL,\n    PIECE_FLAG_UPGRADE,\n} from '../ren/constant';\nimport Piece from '../ren/Piece';\nimport Point from '../ren/Point';\nimport Captured from './Captured';\n\nexport type MovePropType = {\n    piece: Piece;\n    moveFrom: Point;\n    moveTo: Point;\n    isJumping?: boolean; // King or Queen would jump on first start\n    isUpgrading?: boolean;\n    captured?: Captured;\n};\nexport default class Move implements MovePropType {\n    piece: Piece;\n    moveFrom: Point;\n    moveTo: Point;\n    isJumping?: boolean;\n    isUpgrading?: boolean;\n    captured?: Captured;\n    constructor({ piece, moveFrom, moveTo, isJumping,\n        isUpgrading, captured,\n    }: MovePropType) {\n        this.piece = piece;\n        this.moveFrom = moveFrom;\n        this.moveTo = moveTo;\n        this.isJumping = !!isJumping;\n        this.isUpgrading = !!isUpgrading;\n        this.captured = captured || null;\n        if (boardHelper.isUpgradable(piece, moveTo)) {\n            this.isUpgrading = true;\n            piece.upgrade();\n        }\n    }\n\n    // Spec: Fc5d6xf => White fish (F) moved from c5 to d6 killed black fish (f)\n    static fromMovedString(str: string, graveyardLastIndex: number) {\n        const piece = Piece.fromCharCode(str[0]);\n        const moveFrom = Point.fromIndexCode(str.substr(1, 2));\n        const moveTo = Point.fromIndexCode(str.substr(3, 2));\n        const move = new Move({\n            piece,\n            moveFrom,\n            moveTo,\n        });\n        if (str[5] === PIECE_FLAG_KILL) {\n            const capturedPieceChar = str[6];\n            move.captured = new Captured({\n                fromBoardPoint: moveTo,\n                toGraveyardPoint: Point.fromIndexGraveyardIndex(graveyardLastIndex),\n                piece: Piece.fromCharCode(capturedPieceChar),\n            });\n        } else if (str[5] === PIECE_FLAG_JUMP) {\n            move.isJumping = true;\n        }\n        return move;\n    }\n    // Fc5d6j: jump, Fc5d6x: kill, Fc5d6xt: kill&upgrade\n    toString() {\n        const pCode = this.piece.pieceCharCode;\n        const fIndexCode = this.moveFrom.indexCode;\n        const tIndexCode = this.moveTo.indexCode;\n        let flags = this.captured ? PIECE_FLAG_KILL : '';\n        if (this.isJumping) {\n            flags += PIECE_FLAG_JUMP;\n        }\n        if (this.isUpgrading) {\n            flags += PIECE_FLAG_UPGRADE;\n        }\n        return `${pCode}${fIndexCode}${tIndexCode}${flags}`;\n    }\n\n    toJson() {\n        return {\n            fromIndex: this.moveFrom.index,\n            toIndex: this.moveTo.index,\n            isJumping: this.isJumping,\n            capturedPiece: this.captured ? this.captured.piece.pieceCharCode : null,\n        };\n    }\n\n    getMessage(isEnglish?: boolean) {\n        if (isEnglish) {\n            let captured = '';\n            if (this.captured) {\n                captured = ` captures ${this.captured.piece.titleEnglish}`;\n            }\n            const upgrade = this.isUpgrading ? ' transforms' : '';\n            return `${this.piece.titleEnglish} moved from ${this.moveFrom.titleEnglish} to ${this.moveTo.titleEnglish}${upgrade}${captured}`;\n        } else {\n            let captured = '';\n            if (this.captured) {\n                captured = ` ស៊ី${this.captured.piece.title}`;\n            }\n            const upgrade = this.isUpgrading ? ' បក' : '';\n            return `${this.piece.title} ដើរ​ពី ${this.moveFrom.title} ទៅ ${this.moveTo.title}${upgrade}${captured}`;\n        }\n    }\n\n    reverse() {\n    }\n}\n/*\n * Copyright (c) 2021, K4us\n * Author: Raksa Eng <eng.raksa@gmail.com>\n * All rights reserved.\n *\n * Redistribution and use in source and binary forms, with or without\n * modification, are permitted provided that the following conditions are met:\n *\n * 1. Redistributions of source code must retain the above copyright notice,\n *    this list of conditions and the following disclaimer.\n * 2. Redistributions in binary form must reproduce the above copyright notice,\n *    this list of conditions and the following disclaimer in the documentation\n *    and/or other materials provided with the distribution.\n *\n * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS 'AS IS'\n * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE\n * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE\n * ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE\n * LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n * CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF\n * SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS\n * INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN\n * CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)\n * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE\n * POSSIBILITY OF SUCH DAMAGE.\n *\n *---------------------------------------------------------------------------- */","export default class Player {\n    name: string | null = null;\n    id: string | null = null;\n    constructor(id?: string, name?: string) {\n        this.id = id;\n        this.name = name;\n    }\n\n    toJson() {\n        return {\n            id: this.id,\n            name: this.name,\n        };\n    }\n}\n/*\n * Copyright (c) 2021, K4us\n * Author: Raksa Eng <eng.raksa@gmail.com>\n * All rights reserved.\n *\n * Redistribution and use in source and binary forms, with or without\n * modification, are permitted provided that the following conditions are met:\n *\n * 1. Redistributions of source code must retain the above copyright notice,\n *    this list of conditions and the following disclaimer.\n * 2. Redistributions in binary form must reproduce the above copyright notice,\n *    this list of conditions and the following disclaimer in the documentation\n *    and/or other materials provided with the distribution.\n *\n * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS 'AS IS'\n * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE\n * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE\n * ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE\n * LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n * CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF\n * SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS\n * INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN\n * CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)\n * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE\n * POSSIBILITY OF SUCH DAMAGE.\n *\n *---------------------------------------------------------------------------- */","export default class Result {\n    win = 0;\n    draw = 0;\n    lost = 0;\n    constructor(win = 0, draw = 0, lost = 0) {\n        this.win = win;\n        this.draw = draw;\n        this.lost = lost;\n    }\n\n    toJson() {\n        return {\n            win: this.win,\n            draw: this.draw,\n            lost: this.lost,\n        };\n    }\n}\n/*\n * Copyright (c) 2021, K4us\n * Author: Raksa Eng <eng.raksa@gmail.com>\n * All rights reserved.\n *\n * Redistribution and use in source and binary forms, with or without\n * modification, are permitted provided that the following conditions are met:\n *\n * 1. Redistributions of source code must retain the above copyright notice,\n *    this list of conditions and the following disclaimer.\n * 2. Redistributions in binary form must reproduce the above copyright notice,\n *    this list of conditions and the following disclaimer in the documentation\n *    and/or other materials provided with the distribution.\n *\n * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS 'AS IS'\n * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE\n * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE\n * ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE\n * LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n * CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF\n * SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS\n * INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN\n * CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)\n * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE\n * POSSIBILITY OF SUCH DAMAGE.\n *\n *---------------------------------------------------------------------------- */","export default class Timer {\n    bonusTime: number;\n    totalSecond: number;\n    currentWhite: number;\n    currentBlack: number;\n    constructor(totalSecond: number = 0, bonusTime: number = 0,\n        currentWhite: number = 0, currentBlack: number = 0) {\n        this.bonusTime = bonusTime;\n        this.totalSecond = totalSecond;\n        this.currentWhite = currentWhite;\n        this.currentBlack = currentBlack;\n    }\n\n    toJson() {\n        return {\n            totalSecond: this.totalSecond,\n            bonusTime: this.bonusTime,\n            currentWhite: this.currentWhite,\n            currentBlack: this.currentBlack,\n        };\n    }\n}\n/*\n * Copyright (c) 2021, K4us\n * Author: Raksa Eng <eng.raksa@gmail.com>\n * All rights reserved.\n *\n * Redistribution and use in source and binary forms, with or without\n * modification, are permitted provided that the following conditions are met:\n *\n * 1. Redistributions of source code must retain the above copyright notice,\n *    this list of conditions and the following disclaimer.\n * 2. Redistributions in binary form must reproduce the above copyright notice,\n *    this list of conditions and the following disclaimer in the documentation\n *    and/or other materials provided with the distribution.\n *\n * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS 'AS IS'\n * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE\n * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE\n * ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE\n * LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n * CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF\n * SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS\n * INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN\n * CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)\n * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE\n * POSSIBILITY OF SUCH DAMAGE.\n *\n *---------------------------------------------------------------------------- */","export { default as KPGN } from './KPGN';\nexport { default as Move } from './Move';\nexport { MovePropType } from './Move';\nexport { default as Captured } from './Captured';\nexport { CapturedPropType } from './Captured';\nexport { default as Player } from './Player';\nexport { default as Result } from './Result';\nexport { default as Timer } from './Timer';\n/*\n * Copyright (c) 2021, K4us\n * Author: Raksa Eng <eng.raksa@gmail.com>\n * All rights reserved.\n *\n * Redistribution and use in source and binary forms, with or without\n * modification, are permitted provided that the following conditions are met:\n *\n * 1. Redistributions of source code must retain the above copyright notice,\n *    this list of conditions and the following disclaimer.\n * 2. Redistributions in binary form must reproduce the above copyright notice,\n *    this list of conditions and the following disclaimer in the documentation\n *    and/or other materials provided with the distribution.\n *\n * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS 'AS IS'\n * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE\n * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE\n * ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE\n * LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n * CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF\n * SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS\n * INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN\n * CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)\n * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE\n * POSSIBILITY OF SUCH DAMAGE.\n *\n *---------------------------------------------------------------------------- */","import {\r\n    EVENT_FLAG_ATTACK,\r\n    EVENT_FLAG_WINN,\r\n    PieceIndex,\r\n} from '../ren';\r\nimport EventHandler, { ListenerType } from './EventHandler';\r\n\r\nexport class BoardEvent {\r\n    flag: string;\r\n    actorPieceIndex: PieceIndex;\r\n    get isAttack() {\r\n        return this.flag === EVENT_FLAG_ATTACK;\r\n    }\r\n    get isWin() {\r\n        return this.flag === EVENT_FLAG_WINN;\r\n    }\r\n    constructor({ flag, actorPieceIndex }:\r\n        { flag: string, actorPieceIndex: PieceIndex }) {\r\n        this.flag = flag;\r\n        this.actorPieceIndex = actorPieceIndex;\r\n    }\r\n}\r\nexport default class BoardEventController extends EventHandler {\r\n    static EVENT = 'event';\r\n    constructor() {\r\n        super({\r\n            events: {\r\n                EVENT: BoardEventController.EVENT,\r\n            },\r\n        });\r\n    }\r\n    fireEvent(boardEvent: BoardEvent) {\r\n        this._addPropEvent(BoardEventController.EVENT, boardEvent);\r\n    }\r\n    addBoardEventListener(listener: ListenerType<BoardEvent>) {\r\n        this._addOnEventListener(BoardEventController.EVENT, listener);\r\n    }\r\n    removeBoardEventListener(listener: ListenerType<BoardEvent>) {\r\n        this._removeOnEventListener(BoardEventController.EVENT, listener);\r\n    }\r\n}\r\n/*\r\n * Copyright (c) 2021, K4us\r\n * Author: Raksa Eng <eng.raksa@gmail.com>\r\n * All rights reserved.\r\n *\r\n * Redistribution and use in source and binary forms, with or without\r\n * modification, are permitted provided that the following conditions are met:\r\n *\r\n * 1. Redistributions of source code must retain the above copyright notice,\r\n *    this list of conditions and the following disclaimer.\r\n * 2. Redistributions in binary form must reproduce the above copyright notice,\r\n *    this list of conditions and the following disclaimer in the documentation\r\n *    and/or other materials provided with the distribution.\r\n *\r\n * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS 'AS IS'\r\n * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE\r\n * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE\r\n * ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE\r\n * LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\r\n * CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF\r\n * SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS\r\n * INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN\r\n * CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)\r\n * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE\r\n * POSSIBILITY OF SUCH DAMAGE.\r\n *\r\n *---------------------------------------------------------------------------- */","export type ListenerType<T> = (data?: T) => any;\r\n\r\nexport default class EventHandler {\r\n    _onEventListeners: { [key: string]: any } = {};\r\n    _propEvent: any = [];\r\n    events: any;\r\n    _isLockProp: boolean;\r\n    constructor(options: { events: any }) {\r\n        this._onEventListeners = {};\r\n        this._propEvent = [];\r\n        this.events = options.events;\r\n    }\r\n\r\n    _checkPropEvent() {\r\n        if (this._isLockProp) {\r\n            return;\r\n        }\r\n        while (this._propEvent.length) {\r\n            const event = this._propEvent.shift();\r\n            this._checkOnEvent(event.name, event.data);\r\n        }\r\n    }\r\n\r\n    _addPropEvent(event: string, data?: any) {\r\n        this._propEvent.push({\r\n            name: event,\r\n            data,\r\n        });\r\n        this._checkPropEvent();\r\n    }\r\n\r\n    _guardEventName(eventName?: string) {\r\n        if (!eventName) {\r\n            throw new Error('invalid event name');\r\n        }\r\n    }\r\n\r\n    _checkOnEvent(eventName: string, data?: any) {\r\n        this._guardEventName(eventName);\r\n        this._onEventListeners[eventName] = this._onEventListeners[eventName] || [];\r\n        this._onEventListeners[eventName].forEach((listener: ListenerType<any>) => {\r\n            listener(data);\r\n        });\r\n    }\r\n\r\n    _addOnEventListener(eventName: string, listener: ListenerType<any>) {\r\n        this._guardEventName(eventName);\r\n        this._onEventListeners[eventName] = this._onEventListeners[eventName] || [];\r\n        this._onEventListeners[eventName].push(listener);\r\n    }\r\n\r\n    _removeOnEventListener(eventName: string, listener: ListenerType<any>) {\r\n        this._guardEventName(eventName);\r\n        this._onEventListeners[eventName] = this._onEventListeners[eventName] || [];\r\n        const index = this._onEventListeners[eventName].indexOf(listener);\r\n        ~index && this._onEventListeners[eventName].splice(index, 1);\r\n    }\r\n}\r\n/*\r\n * Copyright (c) 2021, K4us\r\n * Author: Raksa Eng <eng.raksa@gmail.com>\r\n * All rights reserved.\r\n *\r\n * Redistribution and use in source and binary forms, with or without\r\n * modification, are permitted provided that the following conditions are met:\r\n *\r\n * 1. Redistributions of source code must retain the above copyright notice,\r\n *    this list of conditions and the following disclaimer.\r\n * 2. Redistributions in binary form must reproduce the above copyright notice,\r\n *    this list of conditions and the following disclaimer in the documentation\r\n *    and/or other materials provided with the distribution.\r\n *\r\n * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS 'AS IS'\r\n * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE\r\n * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE\r\n * ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE\r\n * LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\r\n * CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF\r\n * SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS\r\n * INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN\r\n * CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)\r\n * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE\r\n * POSSIBILITY OF SUCH DAMAGE.\r\n *\r\n *---------------------------------------------------------------------------- */","export { default as EventHandler } from './EventHandler';\nexport { ListenerType } from './EventHandler';\nexport { default as BoardEventController } from './BoardEventController';\nexport { BoardEvent } from './BoardEventController';\nexport { default as table } from './table';\n/*\n * Copyright (c) 2021, K4us\n * Author: Raksa Eng <eng.raksa@gmail.com>\n * All rights reserved.\n *\n * Redistribution and use in source and binary forms, with or without\n * modification, are permitted provided that the following conditions are met:\n *\n * 1. Redistributions of source code must retain the above copyright notice,\n *    this list of conditions and the following disclaimer.\n * 2. Redistributions in binary form must reproduce the above copyright notice,\n *    this list of conditions and the following disclaimer in the documentation\n *    and/or other materials provided with the distribution.\n *\n * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS 'AS IS'\n * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE\n * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE\n * ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE\n * LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n * CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF\n * SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS\n * INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN\n * CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)\n * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE\n * POSSIBILITY OF SUCH DAMAGE.\n *\n *---------------------------------------------------------------------------- */","import REN from '../ren/REN';\n\nexport default function asciiTable(ren: REN) {\n  const arr = ren.board.piecesMultiArray;\n  const str = '  ┏━━━┳━━━┳━━━┳━━━┳━━━┳━━━┳━━━┳━━━┓';\n  const result = arr.reverse().reduce((s, subArr, i) => {\n    const rs = subArr.map((p) => ` ${p ? p.pieceCharCode : ' '} `).join('┃');\n    const bottom = i === arr.length - 1 ? '┗━━━┻━━━┻━━━┻━━━┻━━━┻━━━┻━━━┻━━━┛' : '┣━━━╋━━━╋━━━╋━━━╋━━━╋━━━╋━━━╋━━━┫';\n    s += `\n${8 - i} ┃${rs}┃\n  ${bottom}`;\n    return s;\n  }, str);\n  const gyTStr = ren.graveyard.pieces.map(() => '━━━').join('┳');\n  const gyStr = ren.graveyard.pieces.map((p) => ` ${p ? p.pieceCharCode : ' '} `).join('┃');\n  const gyBStr = ren.graveyard.pieces.map(() => '━━━').join('┻');\n  const graveyardStr = `  ┏${gyTStr}┓\n  ┃${gyStr}┃\n  ┗${gyBStr}┛`;\n  return `${result}\n    a   b   c   d   e   f   g   h\n${graveyardStr}`;\n}\n\n/*\n  ┏━━━┳━━━┳━━━┳━━━┳━━━┳━━━┳━━━┳━━━┓\n8 ┃   ┃   ┃   ┃   ┃ k ┃   ┃   ┃   ┃\n  ┣━━━╋━━━╋━━━╋━━━╋━━━╋━━━╋━━━╋━━━┫\n7 ┃   ┃   ┃   ┃   ┃   ┃   ┃   ┃   ┃\n  ┣━━━╋━━━╋━━━╋━━━╋━━━╋━━━╋━━━╋━━━┫\n6 ┃   ┃   ┃   ┃   ┃   ┃   ┃   ┃   ┃\n  ┣━━━╋━━━╋━━━╋━━━╋━━━╋━━━╋━━━╋━━━┫\n5 ┃   ┃   ┃   ┃   ┃   ┃   ┃   ┃   ┃\n  ┣━━━╋━━━╋━━━╋━━━╋━━━╋━━━╋━━━╋━━━┫\n4 ┃   ┃   ┃   ┃   ┃   ┃   ┃   ┃   ┃\n  ┣━━━╋━━━╋━━━╋━━━╋━━━╋━━━╋━━━╋━━━┫\n3 ┃   ┃   ┃   ┃   ┃   ┃   ┃   ┃   ┃\n  ┣━━━╋━━━╋━━━╋━━━╋━━━╋━━━╋━━━╋━━━┫\n2 ┃   ┃   ┃   ┃   ┃   ┃   ┃   ┃   ┃\n  ┣━━━╋━━━╋━━━╋━━━╋━━━╋━━━╋━━━╋━━━┫\n1 ┃   ┃   ┃   ┃ K ┃   ┃   ┃   ┃   ┃\n  ┗━━━┻━━━┻━━━┻━━━┻━━━┻━━━┻━━━┻━━━┛\n    a   b   c   d   e   f   g   h\n  ┏━━━┳━━━┳━━━┳━━━┳━━━┳━━━┳━━━┳━━━┳━━━┳━━━┳━━━┳━━━┳━━━┳━━━┳━━━┳━━━┳━━━┳━━━┳━━━┳━━━┳━━━┳━━━┳━━━┳━━━┳━━━┳━━━┳━━━┳━━━┳━━━┳━━━┓\n  ┃ b ┃ h ┃ g ┃ q ┃ g ┃ h ┃ b ┃ f ┃ f ┃ f ┃ f ┃ f ┃ f ┃ f ┃ f ┃ F ┃ F ┃ F ┃ F ┃ F ┃ F ┃ F ┃ F ┃ B ┃ H ┃ G ┃ Q ┃ G ┃ H ┃ B ┃\n  ┗━━━┻━━━┻━━━┻━━━┻━━━┻━━━┻━━━┻━━━┻━━━┻━━━┻━━━┻━━━┻━━━┻━━━┻━━━┻━━━┻━━━┻━━━┻━━━┻━━━┻━━━┻━━━┻━━━┻━━━┻━━━┻━━━┻━━━┻━━━┻━━━┻━━━┛\n */\n\n/*\n * Copyright (c) 2021, K4us\n * Author: Raksa Eng <eng.raksa@gmail.com>\n * All rights reserved.\n *\n * Redistribution and use in source and binary forms, with or without\n * modification, are permitted provided that the following conditions are met:\n *\n * 1. Redistributions of source code must retain the above copyright notice,\n *    this list of conditions and the following disclaimer.\n * 2. Redistributions in binary form must reproduce the above copyright notice,\n *    this list of conditions and the following disclaimer in the documentation\n *    and/or other materials provided with the distribution.\n *\n * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS 'AS IS'\n * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE\n * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE\n * ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE\n * LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n * CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF\n * SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS\n * INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN\n * CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)\n * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE\n * POSSIBILITY OF SUCH DAMAGE.\n *\n *---------------------------------------------------------------------------- */","import Piece from './Piece';\nimport PieceIndex from './PieceIndex';\nimport { DEFAULT_BOARD_STR } from './constant';\nimport { BOARD_SEPARATOR, CELL_COUNT, EMPTY_PIECE, ROW_NUMBER } from '../brain/constant';\nimport jsis from '../brain/jsis';\nimport Point from './Point';\n\n/**\n * BHGQKGHB/8/FFFFFFFF/8/8/ffffffff/8/bhgkqghb => bhgqkghb/......../ffffffff/......../......../FFFFFFFF/......../BHGKQGHB\n */\n\nexport default class Board {\n    pieceIndices = Array.from({\n        length: CELL_COUNT,\n    }, (_, i) => {\n        const point = Point.fromIndex(i);\n        return new PieceIndex(point, null);\n    });\n\n    constructor(boardStr: any) {\n        if (jsis.isUndefined(boardStr)) {\n            boardStr = DEFAULT_BOARD_STR;\n        }\n        const newBoardStr = this.extract(boardStr).replace(/\\//g, '');\n        if (newBoardStr.length < CELL_COUNT ||\n            !Piece.isValidPiecesString(newBoardStr)) {\n            throw new Error(`Invalid board string ${boardStr}`);\n        }\n        this.pieceIndices = newBoardStr.split('').map((charCode: string, i: number) => {\n            const point = Point.fromIndex(i);\n            return new PieceIndex(point, charCode === EMPTY_PIECE ? null : Piece.fromCharCode(charCode));\n        });\n    }\n\n    get piecesMultiArray() {\n        const arr: Piece[][] = [[], [], [], [], [], [], [], []];\n        this.pieceIndices.forEach((pieceIndex) => {\n            arr[pieceIndex.point.y][pieceIndex.point.x] = pieceIndex.piece;\n        });\n        return arr;\n    }\n\n    get pieces() {\n        return this.pieceIndices.map((pieceIndex) => {\n            return pieceIndex.piece;\n        });\n    }\n\n    compress(str: string) {\n        const reg = new RegExp(`(\\\\${EMPTY_PIECE}+)`, 'g');\n        return str.replace(reg, ($1: any) => $1.length);\n    }\n\n    extract(str: string) {\n        return str.replace(/(\\d+)/g, ($1: any) => {\n            // $1 == 3 => '...', bh6 => 'bh......'\n            return Array.from({\n                length: $1,\n            }, () => EMPTY_PIECE).join('');\n        });\n    }\n\n    toStringFull(pieceIndices: PieceIndex[] = this.pieceIndices) {\n        const str = pieceIndices.map((pieceIndex, i) => {\n            const p = pieceIndex.toPieceCharCode();\n            if (i && i % ROW_NUMBER === 0 && i !== CELL_COUNT) {\n                return `${BOARD_SEPARATOR}${p}`;\n            }\n            return p;\n        }).join('');\n        return str;\n    }\n    toStringFullNoSeparate() {\n        let str = this.toStringFull();\n        str = str.replace(/\\//g, '');\n        return str;\n    }\n\n    toString(pieceIndices?: PieceIndex[]) {\n        let str = this.toStringFull(pieceIndices);\n        str = this.compress(str);\n        return str;\n    }\n\n    getPieceAtIndex(index: number): Piece | null {\n        return this.pieceIndices[index].piece;\n    }\n}\n/*\n * Copyright (c) 2021, K4us\n * Author: Raksa Eng <eng.raksa@gmail.com>\n * All rights reserved.\n *\n * Redistribution and use in source and binary forms, with or without\n * modification, are permitted provided that the following conditions are met:\n *\n * 1. Redistributions of source code must retain the above copyright notice,\n *    this list of conditions and the following disclaimer.\n * 2. Redistributions in binary form must reproduce the above copyright notice,\n *    this list of conditions and the following disclaimer in the documentation\n *    and/or other materials provided with the distribution.\n *\n * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS 'AS IS'\n * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE\n * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE\n * ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE\n * LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n * CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF\n * SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS\n * INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN\n * CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)\n * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE\n * POSSIBILITY OF SUCH DAMAGE.\n *\n *---------------------------------------------------------------------------- */","import jsis from '../brain/jsis';\nimport { NOT_SET } from './constant';\n\n// 23.-\nexport default class CountDown {\n    white: number | null = null;\n    black: number | null = null;\n    constructor(countdownStr = '') {\n        const newCountdownStr = countdownStr.split('.');\n        this.white = jsis.isStringNumber(newCountdownStr[0]) ? Number(newCountdownStr[0]) : null;\n        this.black = jsis.isStringNumber(newCountdownStr[1]) ? Number(newCountdownStr[1]) : null;\n        if (!jsis.isNull(this.white) && !jsis.isNull(this.white)) {\n            throw new Error(`Invalid countdown string ${countdownStr}`);\n        }\n    }\n\n    toString() {\n        let str = `${jsis.isNull(this.white) ? NOT_SET : this.white}`;\n        str += `.${jsis.isNull(this.black) ? NOT_SET : this.black}`;\n        return str;\n    }\n}\n/*\n * Copyright (c) 2021, K4us\n * Author: Raksa Eng <eng.raksa@gmail.com>\n * All rights reserved.\n *\n * Redistribution and use in source and binary forms, with or without\n * modification, are permitted provided that the following conditions are met:\n *\n * 1. Redistributions of source code must retain the above copyright notice,\n *    this list of conditions and the following disclaimer.\n * 2. Redistributions in binary form must reproduce the above copyright notice,\n *    this list of conditions and the following disclaimer in the documentation\n *    and/or other materials provided with the distribution.\n *\n * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS 'AS IS'\n * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE\n * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE\n * ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE\n * LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n * CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF\n * SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS\n * INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN\n * CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)\n * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE\n * POSSIBILITY OF SUCH DAMAGE.\n *\n *---------------------------------------------------------------------------- */","import Piece from './Piece';\n\nexport default class Graveyard {\n    pieces: Piece[] = [];\n    get lastIndex() {\n        return this.pieces.length - 1;\n    }\n    constructor(graveyardStr?: string) {\n        if (graveyardStr) {\n            if (graveyardStr.length > 30 ||\n                !Piece.isValidPiecesString(graveyardStr, true)) {\n                throw new Error(`Invalid graveyard string ${graveyardStr}`);\n            }\n            this.pieces = graveyardStr.split('').map((charCode, i) => {\n                const p = Piece.fromCharCode(charCode);\n                if (p.isTypeKing) {\n                    throw new Error(`King cannot die graveyard:${graveyardStr}`);\n                }\n                return p;\n            });\n        }\n    }\n\n    toString() {\n        return this.pieces.map((p) => {\n            return p.pieceCharCode;\n        }).join('');\n    }\n}\n/*\n * Copyright (c) 2021, K4us\n * Author: Raksa Eng <eng.raksa@gmail.com>\n * All rights reserved.\n *\n * Redistribution and use in source and binary forms, with or without\n * modification, are permitted provided that the following conditions are met:\n *\n * 1. Redistributions of source code must retain the above copyright notice,\n *    this list of conditions and the following disclaimer.\n * 2. Redistributions in binary form must reproduce the above copyright notice,\n *    this list of conditions and the following disclaimer in the documentation\n *    and/or other materials provided with the distribution.\n *\n * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS 'AS IS'\n * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE\n * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE\n * ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE\n * LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n * CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF\n * SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS\n * INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN\n * CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)\n * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE\n * POSSIBILITY OF SUCH DAMAGE.\n *\n *---------------------------------------------------------------------------- */","import { PIECE_TYPE_KING } from '../brain/constant';\nimport { NOT_SET } from './constant';\nimport Piece from './Piece';\n\n/**\n * King has attacked, this will effect jumping\n */\nexport default class KAttacked {\n    whiteKing = false;\n    blackKing = false;\n    constructor(kAttackedStr?: string) {\n        if (kAttackedStr) {\n            this.whiteKing = !!~kAttackedStr.indexOf(Piece.toWhiteCharCode(PIECE_TYPE_KING));\n            this.blackKing = !!~kAttackedStr.indexOf(PIECE_TYPE_KING);\n        }\n    }\n\n    toString() {\n        let str = `${this.whiteKing ? Piece.toWhiteCharCode(PIECE_TYPE_KING) : NOT_SET}`;\n        str += `${this.blackKing ? PIECE_TYPE_KING : NOT_SET}`;\n        return str;\n    }\n}\n/*\n * Copyright (c) 2021, K4us\n * Author: Raksa Eng <eng.raksa@gmail.com>\n * All rights reserved.\n *\n * Redistribution and use in source and binary forms, with or without\n * modification, are permitted provided that the following conditions are met:\n *\n * 1. Redistributions of source code must retain the above copyright notice,\n *    this list of conditions and the following disclaimer.\n * 2. Redistributions in binary form must reproduce the above copyright notice,\n *    this list of conditions and the following disclaimer in the documentation\n *    and/or other materials provided with the distribution.\n *\n * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS 'AS IS'\n * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE\n * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE\n * ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE\n * LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n * CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF\n * SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS\n * INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN\n * CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)\n * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE\n * POSSIBILITY OF SUCH DAMAGE.\n *\n *---------------------------------------------------------------------------- */","import { PIECE_TYPE_KING, PIECE_TYPE_QUEEN } from '../brain/constant';\nimport { NOT_SET } from './constant';\nimport Piece from './Piece';\n\n/**\n * King or Queen has moved, the will effect jumping\n */\nexport default class KqMoved {\n    whiteKing = false;\n    whiteQueen = false;\n    blackKing = false;\n    blackQueen = false;\n    constructor(kqMovedStr?: string) {\n        if (kqMovedStr) {\n            this.whiteKing = !!~kqMovedStr.indexOf(Piece.toWhiteCharCode(PIECE_TYPE_KING));\n            this.whiteQueen = !!~kqMovedStr.indexOf(Piece.toWhiteCharCode(PIECE_TYPE_QUEEN));\n            this.blackKing = !!~kqMovedStr.indexOf(PIECE_TYPE_KING);\n            this.blackQueen = !!~kqMovedStr.indexOf(PIECE_TYPE_QUEEN);\n        }\n    }\n\n    toString() {\n        let str = `${this.whiteKing ? Piece.toWhiteCharCode(PIECE_TYPE_KING) : NOT_SET}`;\n        str += `${this.whiteQueen ? Piece.toWhiteCharCode(PIECE_TYPE_QUEEN) : NOT_SET}`;\n        str += `${this.blackKing ? PIECE_TYPE_KING : NOT_SET}`;\n        str += `${this.blackQueen ? PIECE_TYPE_QUEEN : NOT_SET}`;\n        return str;\n    }\n}\n/*\n * Copyright (c) 2021, K4us\n * Author: Raksa Eng <eng.raksa@gmail.com>\n * All rights reserved.\n *\n * Redistribution and use in source and binary forms, with or without\n * modification, are permitted provided that the following conditions are met:\n *\n * 1. Redistributions of source code must retain the above copyright notice,\n *    this list of conditions and the following disclaimer.\n * 2. Redistributions in binary form must reproduce the above copyright notice,\n *    this list of conditions and the following disclaimer in the documentation\n *    and/or other materials provided with the distribution.\n *\n * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS 'AS IS'\n * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE\n * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE\n * ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE\n * LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n * CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF\n * SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS\n * INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN\n * CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)\n * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE\n * POSSIBILITY OF SUCH DAMAGE.\n *\n *---------------------------------------------------------------------------- */","import {\n    PIECE_COLOR_BLACK,\n    PIECE_COLOR_WHITE,\n    PIECE_TYPE_TRANSFORM_FISH,\n    PIECE_TYPE_FISH,\n    PIECE_TYPE_BOAT,\n    PIECE_TYPE_HORSE,\n    PIECE_TYPE_GENERAL,\n    PIECE_TYPE_KING,\n    PIECE_TYPE_QUEEN,\n    EMPTY_PIECE,\n    BOARD_SEPARATOR,\n    PIECE_NAMES,\n    COLOR_NAMES,\n    PIECE_NAMES_ENGLISH,\n    COLOR_NAMES_ENGLISH,\n} from '../brain/constant';\nimport jsis from '../brain/jsis';\n\nexport default class Piece {\n    type: string;\n    color: string;\n    get colorOpponent() {\n        return Piece.oppositeColor(this.color);\n    }\n    get pieceCharCode() {\n        if (this.isColorWhite) {\n            return this.pieceCharCodeWhite;\n        }\n        return this.type;\n    }\n    get pieceCharCodeWhite() {\n        return Piece.toWhiteCharCode(this.type);\n    }\n\n    get title() {\n        return `${PIECE_NAMES[this.type]}${COLOR_NAMES[this.color]}`;\n    }\n    get titleEnglish() {\n        return `${COLOR_NAMES_ENGLISH[this.color]}-${PIECE_NAMES_ENGLISH[this.type]}`;\n    }\n    _isTypeEqual(type: string) {\n        return this.type === type;\n    }\n    get isTypeKing() {\n        return this._isTypeEqual(PIECE_TYPE_KING);\n    }\n    get isTypeQueen() {\n        return this._isTypeEqual(PIECE_TYPE_QUEEN);\n    }\n    get isTypeBoat() {\n        return this._isTypeEqual(PIECE_TYPE_BOAT);\n    }\n    get isTypeHorse() {\n        return this._isTypeEqual(PIECE_TYPE_HORSE);\n    }\n    get isTypeGeneral() {\n        return this._isTypeEqual(PIECE_TYPE_GENERAL);\n    }\n    get isTypeFish() {\n        return this._isTypeEqual(PIECE_TYPE_FISH);\n    }\n    get isTypeTransformedFish() {\n        return this._isTypeEqual(PIECE_TYPE_TRANSFORM_FISH);\n    }\n    get isColorBlack() {\n        return Piece.isBlackColor(this.color);\n    }\n    get isColorWhite() {\n        return Piece.isWhiteColor(this.color);\n    }\n\n\n    constructor(type: string, color: string) {\n        this.type = Piece.toNormalCharCode(type);\n        this.color = color;\n    }\n\n    static fromCharCode(charCode: string) {\n        if (!Piece.isValidPiece(charCode)) {\n            return null;\n        }\n        const color = Piece.isWhiteCharCode(charCode) ? PIECE_COLOR_WHITE : PIECE_COLOR_BLACK;\n        const type = Piece.toNormalCharCode(charCode);\n        return new Piece(type, color);\n    }\n\n    get originPiece(): Piece {\n        if (this.isTypeTransformedFish) {\n            return new Piece(PIECE_TYPE_FISH, this.color);\n        }\n        return this;\n    }\n\n    static get pieceChars() {\n        return [\n            PIECE_TYPE_BOAT,\n            PIECE_TYPE_HORSE,\n            PIECE_TYPE_GENERAL,\n            PIECE_TYPE_KING,\n            PIECE_TYPE_QUEEN,\n            PIECE_TYPE_FISH,\n            PIECE_TYPE_TRANSFORM_FISH,\n        ];\n    }\n    static get colorChars() {\n        return [\n            PIECE_COLOR_WHITE,\n            PIECE_COLOR_BLACK,\n        ];\n    }\n\n\n    static toWhiteCharCode(charCode: string) {\n        return charCode.toUpperCase();\n    }\n    static isWhiteCharCode(charCode: string) {\n        return jsis.isUpperCase(charCode);\n    }\n    static toBlackCharCode(charCode: string) {\n        return charCode.toLowerCase();\n    }\n    static toNormalCharCode(charCode: string) {\n        return Piece.toBlackCharCode(charCode);\n    }\n\n    static isValidPiece(charCode: string) {\n        return charCode !== EMPTY_PIECE;\n    }\n    static isWhiteColor(color: string) {\n        return color === PIECE_COLOR_WHITE;\n    }\n    static isBlackColor(color: string) {\n        return color === PIECE_COLOR_BLACK;\n    }\n    static oppositeColor(color: any) {\n        return Piece.isWhiteColor(color) ? PIECE_COLOR_BLACK : PIECE_COLOR_WHITE;\n    }\n\n    static isValidPiecesString(str: string, onlyPiece?: boolean) {\n        const ruler = onlyPiece ? allPiecesString.filter((c: string) => {\n            return !~[EMPTY_PIECE, BOARD_SEPARATOR].indexOf(c);\n        }) : allPiecesString;\n        return !str.split('').some((c: string) => {\n            return !~ruler.indexOf(c);\n        });\n    }\n\n    upgrade() {\n        if (this.isTypeFish) {\n            this.type = PIECE_TYPE_TRANSFORM_FISH;\n            return true;\n        }\n        return false;\n    }\n    downgrade() {\n        if (this.isTypeTransformedFish) {\n            this.type = PIECE_TYPE_FISH;\n            return true;\n        }\n        return false;\n    }\n}\n\nconst allPiecesString: string[] = [\n    ...Piece.pieceChars,\n    ...Piece.pieceChars.map((pieceChar: string) => {\n        return Piece.toWhiteCharCode(pieceChar);\n    }),\n    EMPTY_PIECE,\n    BOARD_SEPARATOR,\n];\n/*\n * Copyright (c) 2021, K4us\n * Author: Raksa Eng <eng.raksa@gmail.com>\n * All rights reserved.\n *\n * Redistribution and use in source and binary forms, with or without\n * modification, are permitted provided that the following conditions are met:\n *\n * 1. Redistributions of source code must retain the above copyright notice,\n *    this list of conditions and the following disclaimer.\n * 2. Redistributions in binary form must reproduce the above copyright notice,\n *    this list of conditions and the following disclaimer in the documentation\n *    and/or other materials provided with the distribution.\n *\n * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS 'AS IS'\n * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE\n * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE\n * ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE\n * LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n * CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF\n * SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS\n * INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN\n * CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)\n * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE\n * POSSIBILITY OF SUCH DAMAGE.\n *\n *---------------------------------------------------------------------------- */","import { EMPTY_PIECE } from '../brain/constant';\nimport jsis from '../brain/jsis';\nimport Piece from './Piece';\nimport Point from './Point';\n\nexport default class PieceIndex {\n    point: Point;\n    piece: Piece | null;\n    canMovePoints: Point[] = [];\n    constructor(point: Point, piece: Piece | null) {\n        this.point = point;\n        this.piece = piece;\n    }\n\n    toCode() {\n        return jsis.isNull(this.piece) ? `${this.piece.pieceCharCode}${this.point.indexCode}` : null;\n    }\n\n    toPieceCharCode() {\n        return jsis.isNull(this.piece) ? EMPTY_PIECE : this.piece.pieceCharCode;\n    }\n}\n/*\n * Copyright (c) 2021, K4us\n * Author: Raksa Eng <eng.raksa@gmail.com>\n * All rights reserved.\n *\n * Redistribution and use in source and binary forms, with or without\n * modification, are permitted provided that the following conditions are met:\n *\n * 1. Redistributions of source code must retain the above copyright notice,\n *    this list of conditions and the following disclaimer.\n * 2. Redistributions in binary form must reproduce the above copyright notice,\n *    this list of conditions and the following disclaimer in the documentation\n *    and/or other materials provided with the distribution.\n *\n * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS 'AS IS'\n * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE\n * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE\n * ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE\n * LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n * CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF\n * SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS\n * INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN\n * CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)\n * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE\n * POSSIBILITY OF SUCH DAMAGE.\n *\n *---------------------------------------------------------------------------- */","\nimport {\n    CELL_COUNT,\n    HORIZONTAL_CODE_LETTERS,\n    HORIZONTAL_NOTE_LETTERS,\n    ROW_NUMBER,\n    VERTICAL_NOTE_LETTERS,\n} from '../brain/constant';\n\nexport default class Point {\n    x: number;\n    y: number;\n    get index() {\n        return Point.xyToIndex(this.x, this.y);\n    }\n    get graveyardIndex() {\n        return this.x;\n    }\n    get indexCode() {\n        return `${this.h}${this.v}`;\n    }\n    get title() {\n        return `${HORIZONTAL_NOTE_LETTERS[this.x]}${VERTICAL_NOTE_LETTERS[this.y]}`;\n    }\n    get titleEnglish() {\n        return this.indexCode;\n    }\n    get h() {\n        return HORIZONTAL_CODE_LETTERS[this.x];\n    }\n    get v() {\n        return this.y + 1;\n    }\n    constructor(x: number, y: number) {\n        this.x = x;\n        this.y = y;\n    }\n    static xyToIndex(x: number, y: number) {\n        return y * ROW_NUMBER + x;\n    }\n    static indexCodeToXY(indexCode: string) {\n        const x = HORIZONTAL_CODE_LETTERS.indexOf(indexCode[0]);\n        const y = Number(indexCode[1]) - 1;\n        return { x, y };\n    }\n    static indexCodeToIndex(indexCode: string) {\n        const { x, y } = Point.indexCodeToXY(indexCode);\n        return Point.xyToIndex(x, y);\n    }\n    static fromIndexCode(indexCode: string) {\n        const { x, y } = Point.indexCodeToXY(indexCode);\n        return new Point(x, y);\n    }\n    static indexToXY(index: number) {\n        const x = index % ROW_NUMBER;\n        const y = Math.floor(index / ROW_NUMBER);\n        return { x, y };\n    }\n    static fromIndex(index: number) {\n        const { x, y } = Point.indexToXY(index);\n        return new Point(x, y);\n    }\n    static fromIndexGraveyardIndex(index: number) {\n        return new Point(index, 0);\n    }\n    static isIndexInBoard(index: number) {\n        return index >= 0 && index <= CELL_COUNT - 1;\n    }\n}\n/*\n * Copyright (c) 2021, K4us\n * Author: Raksa Eng <eng.raksa@gmail.com>\n * All rights reserved.\n *\n * Redistribution and use in source and binary forms, with or without\n * modification, are permitted provided that the following conditions are met:\n *\n * 1. Redistributions of source code must retain the above copyright notice,\n *    this list of conditions and the following disclaimer.\n * 2. Redistributions in binary form must reproduce the above copyright notice,\n *    this list of conditions and the following disclaimer in the documentation\n *    and/or other materials provided with the distribution.\n *\n * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS 'AS IS'\n * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE\n * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE\n * ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE\n * LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n * CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF\n * SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS\n * INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN\n * CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)\n * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE\n * POSSIBILITY OF SUCH DAMAGE.\n *\n *---------------------------------------------------------------------------- */","import Board from './Board';\nimport KqMoved from './KqMoved';\nimport KAttacked from './KAttacked';\nimport CountDown from './CountDown';\nimport Graveyard from './Graveyard';\nimport {\n    DEFAULT_BOARD_STR,\n    STRING_COUNT,\n} from './constant';\nimport { Captured } from '../kpgn';\nimport Move from '../kpgn/Move';\nimport Point from './Point';\nimport Piece from './Piece';\nimport { PieceIndex } from '.';\nimport MoveHelper from '../brain/MoveHelper';\nimport { PIECE_COLOR_WHITE } from '../brain/constant';\nimport jsis from '../brain/jsis';\n\n/**\n * Raksa-Eng Notation\n * ren: <pieces on board> <turn w|b> <king&queen moved ----|SNsn> <king attack --|Kk> <countdown -.-|-.4> <pieces in graveyard>\n */\nexport type RENPropType = {\n    boardStr: string;\n    turnStr: string;\n    kqMovedStr: string;\n    kAttackedStr: string;\n    countdownStr: string;\n    graveyardStr: string;\n}\nexport default class REN {\n    board: Board;\n    turn: string;\n    kqMoved: KqMoved;\n    kAttacked: KAttacked;\n    countdown: CountDown;\n    graveyard: Graveyard;\n    moveHelper: MoveHelper;\n    constructor(renProps: RENPropType) {\n        this.moveHelper = new MoveHelper();\n        this.init(renProps);\n    }\n\n    init({\n        boardStr,\n        turnStr,\n        kqMovedStr,\n        kAttackedStr,\n        countdownStr,\n        graveyardStr }: RENPropType) {\n        this.board = new Board(boardStr);\n        this.turn = turnStr || PIECE_COLOR_WHITE;\n        this.kqMoved = new KqMoved(kqMovedStr);\n        this.kAttacked = new KAttacked(kAttackedStr);\n        this.countdown = new CountDown(countdownStr);\n        this.graveyard = new Graveyard(graveyardStr);\n        const invalidPiecesString = this.isInvalidPieceCount();\n        if (invalidPiecesString) {\n            let msg = `Invalid piece string board:${boardStr}`;\n            msg += `, graveyard:${graveyardStr}, count:${invalidPiecesString}`;\n            throw new Error(msg);\n        }\n        this.moveHelper = new MoveHelper();\n    }\n\n    isInvalidPieceCount() {\n        const pieces = this.board.pieceIndices.map((pos) => {\n            return pos.piece;\n        }).filter((p) => {\n            return !jsis.isNull(p);\n        }).concat(this.graveyard.pieces).map((p) => {\n            return p.originPiece;\n        });\n        const piecesCount = pieces.reduce((obj: any, p) => {\n            obj[p.pieceCharCode] = obj[p.pieceCharCode] || 0;\n            obj[p.pieceCharCode]++;\n            return obj;\n        }, {});\n        const str = Object.keys(piecesCount).map((k) => {\n            return `${k}${piecesCount[k]}`;\n        }).sort().join('');\n        if (str === STRING_COUNT) {\n            return false;\n        }\n        return str;\n    }\n\n    static fromString(renStr?: string) {\n        if (jsis.isUndefined(renStr)) {\n            renStr = DEFAULT_BOARD_STR;\n        }\n        const renArr = renStr.split(' ');\n        return new REN({\n            boardStr: renArr[0],\n            turnStr: renArr[1],\n            kqMovedStr: renArr[2],\n            kAttackedStr: renArr[3],\n            countdownStr: renArr[4],\n            graveyardStr: renArr[5],\n        });\n    }\n\n    move(moveFromIndex: number, moveToIndex: number): Move | null {\n        const piece = this.board.getPieceAtIndex(moveFromIndex);\n        if (jsis.isNull(piece)) {\n            return null;\n        }\n        this.board.pieceIndices[moveFromIndex].piece = null;\n        const move = new Move({\n            moveFrom: Point.fromIndex(moveFromIndex),\n            moveTo: Point.fromIndex(moveToIndex),\n            piece,\n        });\n        const targetPiece = this.board.getPieceAtIndex(moveToIndex);\n        if (targetPiece) {\n            this.graveyard.pieces.push(targetPiece);\n            move.captured = new Captured({\n                fromBoardPoint: Point.fromIndex(moveToIndex),\n                toGraveyardPoint: Point.fromIndex(this.graveyard.lastIndex),\n                piece: targetPiece,\n            });\n        }\n        this.board.pieceIndices[moveToIndex].piece = piece;\n        return move;\n    }\n\n    toString() {\n        let str = this.board.toString();\n        str += ` ${this.turn.toString()}`;\n        str += ` ${this.kqMoved.toString()}`;\n        str += ` ${this.kAttacked.toString()}`;\n        str += ` ${this.countdown.toString()}`;\n        str += ` ${this.graveyard.toString()}`;\n        return str;\n    }\n\n    get isQueenMoved() {\n        const isQueenMoved = Piece.isWhiteColor(this.turn) && this.kqMoved.whiteQueen ||\n            Piece.isBlackColor(this.turn) && this.kqMoved.blackQueen;\n        return isQueenMoved;\n    }\n    get isKingMoved() {\n        const isKingMoved = Piece.isWhiteColor(this.turn) && this.kqMoved.whiteKing ||\n            Piece.isBlackColor(this.turn) && this.kqMoved.blackKing;\n        return isKingMoved;\n    }\n    genAllCanMoves(): PieceIndex[] {\n        const canMoves = this.moveHelper.calcCanMove({\n            piecesString: this.board.toStringFullNoSeparate(),\n            currentTurn: this.turn,\n            isQueenMoved: this.isQueenMoved,\n            isKingMoved: this.isKingMoved,\n            genCanMove: true,\n            genCanMoveForAnother: false,\n        });\n        return canMoves.moves;\n    }\n    isHasMoved(piece: Piece) {\n        let isHasMoved = false;\n        if ((this.kqMoved.blackKing && piece.isColorBlack && piece.isTypeKing) ||\n            (this.kqMoved.whiteKing && piece.isColorWhite && piece.isTypeKing) ||\n            (this.kqMoved.blackQueen && piece.isColorBlack && piece.isTypeQueen) ||\n            (this.kqMoved.whiteQueen && piece.isColorWhite && piece.isTypeQueen)) {\n            isHasMoved = true;\n        }\n        return isHasMoved;\n    }\n    getCanMovePointsByPoint(point: Point): Point[] {\n        const piece = this.board.getPieceAtIndex(point.index);\n        if (jsis.isNull(piece)) {\n            return [];\n        }\n        return this.moveHelper.genCanMovePointsByPiecePoint(point, piece,\n            this.board.toStringFullNoSeparate(), this.isHasMoved(piece));\n    }\n\n    getAttacker(): PieceIndex | null {\n        const state = this.moveHelper.calcState({\n            piecesString: this.board.toStringFullNoSeparate(),\n            currentTurn: this.turn,\n            isQueenMoved: this.isQueenMoved,\n            isKingMoved: this.isKingMoved,\n            genCanMove: false,\n            genCanMoveForAnother: false,\n        });\n        const kingInDanger = state.blackKingInDanger || state.whiteKingInDanger;\n        if (kingInDanger) {\n            const pieceIndex = kingInDanger.map((point) => {\n                return new PieceIndex(point, this.board.getPieceAtIndex(point.index));\n            }).filter((pieceIndex) => {\n                return !pieceIndex.piece.isTypeKing;\n            })[0];\n            return pieceIndex;\n        }\n        return null;\n    }\n    getWinColor(): string | null {\n        const state = this.moveHelper.calcState({\n            piecesString: this.board.toStringFullNoSeparate(),\n            currentTurn: this.turn,\n            isQueenMoved: this.isQueenMoved,\n            isKingMoved: this.isKingMoved,\n            genCanMove: false,\n            genCanMoveForAnother: false,\n        });\n        return state.winColor;\n    }\n}\n/*\n * Copyright (c) 2021, K4us\n * Author: Raksa Eng <eng.raksa@gmail.com>\n * All rights reserved.\n *\n * Redistribution and use in source and binary forms, with or without\n * modification, are permitted provided that the following conditions are met:\n *\n * 1. Redistributions of source code must retain the above copyright notice,\n *    this list of conditions and the following disclaimer.\n * 2. Redistributions in binary form must reproduce the above copyright notice,\n *    this list of conditions and the following disclaimer in the documentation\n *    and/or other materials provided with the distribution.\n *\n * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS 'AS IS'\n * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE\n * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE\n * ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE\n * LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n * CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF\n * SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS\n * INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN\n * CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)\n * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE\n * POSSIBILITY OF SUCH DAMAGE.\n *\n *---------------------------------------------------------------------------- */","// BHGQKGHB/8/FFFFFFFF/8/8/ffffffff/8/bhgkqghb w ---- -- -.-\nexport const STRING_COUNT = 'B2F8G2H2K1Q1b2f8g2h2k1q1';\n// BHGQKGHB/8/FFFFFFFF/8/8/ffffffff/8/bhgkqghb w ---- -- -.-\nexport const DEFAULT_BOARD_STR = 'BHGKQGHB/8/FFFFFFFF/8/8/ffffffff/8/bhgqkghb';\nexport const NOT_SET = '-';\nexport const PIECE_FLAG_KILL = 'x';\nexport const PIECE_FLAG_JUMP = 'j';\nexport const PIECE_FLAG_UPGRADE = 'u';\nexport const EVENT_FLAG_ATTACK = 'attack';\nexport const EVENT_FLAG_WINN = 'win';\nexport const EVENT_FLAG_DRAW = 'draw';\n/*\n * Copyright (c) 2021, K4us\n * Author: Raksa Eng <eng.raksa@gmail.com>\n * All rights reserved.\n *\n * Redistribution and use in source and binary forms, with or without\n * modification, are permitted provided that the following conditions are met:\n *\n * 1. Redistributions of source code must retain the above copyright notice,\n *    this list of conditions and the following disclaimer.\n * 2. Redistributions in binary form must reproduce the above copyright notice,\n *    this list of conditions and the following disclaimer in the documentation\n *    and/or other materials provided with the distribution.\n *\n * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS 'AS IS'\n * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE\n * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE\n * ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE\n * LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n * CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF\n * SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS\n * INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN\n * CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)\n * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE\n * POSSIBILITY OF SUCH DAMAGE.\n *\n *---------------------------------------------------------------------------- */","export { default as Board } from './Board';\nexport { default as CountDown } from './CountDown';\nexport { default as Graveyard } from './Graveyard';\nexport { default as KAttacked } from './KAttacked';\nexport { default as KqMoved } from './KqMoved';\nexport { default as Piece } from './Piece';\nexport { default as PieceIndex } from './PieceIndex';\nexport { default as REN } from './REN';\nexport { RENPropType } from './REN';\nexport { default as Point } from './Point';\nexport * from './constant';\n/*\n * Copyright (c) 2021, K4us\n * Author: Raksa Eng <eng.raksa@gmail.com>\n * All rights reserved.\n *\n * Redistribution and use in source and binary forms, with or without\n * modification, are permitted provided that the following conditions are met:\n *\n * 1. Redistributions of source code must retain the above copyright notice,\n *    this list of conditions and the following disclaimer.\n * 2. Redistributions in binary form must reproduce the above copyright notice,\n *    this list of conditions and the following disclaimer in the documentation\n *    and/or other materials provided with the distribution.\n *\n * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS 'AS IS'\n * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE\n * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE\n * ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE\n * LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR\n * CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF\n * SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS\n * INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN\n * CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)\n * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE\n * POSSIBILITY OF SUCH DAMAGE.\n *\n *---------------------------------------------------------------------------- */","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// startup\n// Load entry module and return exports\n// This entry module is referenced by other modules so it can't be inlined\nvar __webpack_exports__ = __webpack_require__(303);\n"],"names":["root","factory","exports","module","define","amd","a","i","self","renStr","ren","fromString","this","kpgn","boardEventController","loadRENStr","loadMovesStrings","moves","graveyardLastIndex","map","move","moved","fromMovedString","captured","toGraveyardPoint","index","resetBoard","getCanMoves","genAllCanMoves","getCanMovePointsByPoint","point","getAttacker","getWinColor","getStuckColor","isDraw","getDrawCountColor","gameOver","validateRENStr","valid","error_number","error","message","getRENStr","toString","board","piecesMultiArray","pieces","graveyard","getKPGN","toJson","loadKpgn","kpgnJosn","options","drawAscii","turn","moveFromIndex","moveToIndex","push","undoMove","clearBoard","getHistories","checkBoardEvent","pieceIndex","jsis","isNull","boardEvent","BoardEvent","flag","EVENT_FLAG_ATTACK","actorPieceIndex","fireEvent","winColor","addBoardEventListener","listener","removeBoardEventListener","title","name","version","KhmerChess","h","v","isUndefined","Number","HORIZONTAL_CODE_LETTERS","indexOf","isWhiteColor","currentTurn","init","option","piecesString","isQueenMoved","isKingMoved","genCanMove","genCanMoveForAnother","whiteMoves","blackMoves","whiteKingInDanger","whiteKingWillInDanger","blackKingInDanger","blackKingWillInDanger","stuckColor","generateCanMoves","filter","filterPieceInBoard","whitePieces","blackPieces","genMoves","pieceIndices","forEach","isHaveMoved","piece","isTypeKing","isTypeQueen","canMovePoints","genCanMovePointsByPiecePoint","cleanPieceNoMove","cleanMoves","isTrue","length","splice","checkIfKingInDanger","getKingInDanger","PIECE_COLOR_WHITE","getKingWillInDanger","PIECE_COLOR_BLACK","genWinLost","getStuck","isWhiteTurn","calcCanMove","anotherMoves","calcState","blackCountable","checkCountable","whiteCountable","calCount","countingBlack","checkCount","force","countingWhite","isHasMoved","x","y","width","height","isContainsPoint","isValidPoint","Rectangle","ROW_LAST_INDEX","TRIGGER_MOVE","events","removeOnTriggerMoveEventListener","_removeOnEventListener","addOnTriggerMoveEventListener","_addOnEventListener","mask","convertMask","point1","color","sign","point2","fromIndex","getCharPieceFromString","isIndexInBoard","CELL_COUNT","EMPTY_PIECE","getCharPieceInPos","getPieceByIndex","charCode","isValidPiece","fromCharCode","getPieceCanMovePoses","type","_pos","newIndex","getPieceCanMovePosesValid","_poses","n","thisPos","p","distPiece","isTypeFish","isTypeBoat","_x","_y","_n","Math","abs","_s","xyToIndex","replacePiecesStringAtIndex","substring","injectPiece","index1","index2","c","isCharPiecesInBoard","kingPos","PIECE_TYPE_KING","pieceCharCode","j","isHaveCaptured","points","str","code","getPiecesInBoard","split","ROW_NUMBER","PieceIndex","isColorWhite","extractPiecesToArray","piecesStringArr","pieceAll","isStateCount","weaker","stronger","oppositeColor","countChar","join","PIECE_TYPE_FISH","count","toukCount","PIECE_TYPE_BOAT","PIECE_TYPE_GENERAL","PIECE_TYPE_HORSE","isUpgradable","isColorBlack","BoardHelper","COLOR_NAMES","COLOR_NAMES_ENGLISH","PIECE_TYPE_QUEEN","PIECE_TYPE_TRANSFORM_FISH","PIECE_NAMES","PIECE_NAMES_ENGLISH","PIECE_COLOR_EMPTY","BOARD_SEPARATOR","ROW_FIRST_INDEX","HORIZONTAL_NOTE_LETTERS","VERTICAL_NOTE_LETTERS","HORIZONTAL_NOTE_LETTERS_ENGLISH","VERTICAL_NOTE_LETTERS_ENGLISH","Array","from","_","concat","default","isValid","isString","isNotEmpty","isValidString","isNumber","isStringNumber","isNaN","isArray","arr","isFunction","f","isObject","o","Object","isBoolean","b","isValidBoolean","isFalse","isPoint","isValidObject","isValidNumber","isSize","size","isOdd","isEven","isUpperCase","toUpperCase","fromBoardPoint","event","date","location","players","white","black","result","last","whiteWin","blackWin","timer","m","moveFrom","moveTo","isJumping","isUpgrading","boardHelper","upgrade","fromIndexCode","substr","Move","PIECE_FLAG_KILL","capturedPieceChar","fromIndexGraveyardIndex","PIECE_FLAG_JUMP","pCode","fIndexCode","indexCode","tIndexCode","flags","PIECE_FLAG_UPGRADE","toIndex","capturedPiece","getMessage","isEnglish","titleEnglish","reverse","id","win","draw","lost","totalSecond","bonusTime","currentWhite","currentBlack","EVENT_FLAG_WINN","EVENT","BoardEventController","_addPropEvent","_onEventListeners","_propEvent","_checkPropEvent","_isLockProp","shift","_checkOnEvent","data","_guardEventName","eventName","Error","reduce","s","subArr","boardStr","DEFAULT_BOARD_STR","newBoardStr","extract","replace","isValidPiecesString","compress","reg","RegExp","$1","toStringFull","toPieceCharCode","toStringFullNoSeparate","getPieceAtIndex","countdownStr","newCountdownStr","NOT_SET","graveyardStr","kAttackedStr","whiteKing","blackKing","toWhiteCharCode","kqMovedStr","whiteQueen","blackQueen","Piece","toNormalCharCode","pieceCharCodeWhite","_isTypeEqual","isBlackColor","isWhiteCharCode","isTypeTransformedFish","toBlackCharCode","toLowerCase","onlyPiece","ruler","allPiecesString","some","downgrade","pieceChars","pieceChar","toCode","Point","indexCodeToXY","indexCodeToIndex","indexToXY","floor","renProps","moveHelper","turnStr","kqMoved","kAttacked","countdown","invalidPiecesString","isInvalidPieceCount","msg","piecesCount","pos","originPiece","obj","keys","k","sort","STRING_COUNT","renArr","REN","targetPiece","Captured","lastIndex","state","kingInDanger","EVENT_FLAG_DRAW","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","__webpack_modules__","call"],"sourceRoot":""}