(()=>{"use strict";var t={497:(t,e,i)=>{function n(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function r(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var s=i(163).KPGN,o=i(620),c=i(490),a=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),r(this,"moveHelper",new o),r(this,"renInstance",c.toRen()),r(this,"kpgnInstance",new s),this.renInstance=c.toRen(e)}var e,i;return e=t,(i=[{key:"load",value:function(t){this.renInstance=c.toRen(t)}},{key:"reset",value:function(){this.renInstance=c.toRen()}},{key:"moves",value:function(){return[]}},{key:"in_check",value:function(){return null}},{key:"in_checkmate",value:function(){return null}},{key:"in_stalemate",value:function(){return null}},{key:"in_draw",value:function(){return!1}},{key:"in_draw_count",value:function(){return null}},{key:"game_over",value:function(){return!1}},{key:"validate_ren",value:function(t){try{return c.toRen(t),{valid:!0,error_number:0,error:"No errors."}}catch(t){return{valid:!1,error_number:1,error:t.message}}}},{key:"ren",value:function(){return this.renInstance.toString()}},{key:"board",value:function(){return this.renInstance.board.toMultiArray()}},{key:"kpgn",value:function(){return this.kpgnInstance.toJson()}},{key:"load_kpgn",value:function(t,e){this.kpgnInstance=new s(t)}},{key:"ascii",value:function(){var t=this.renInstance.board.toMultiArray(),e=t.reduce((function(e,i,n){var r=i.map((function(t){return" ".concat(t?t.toString():" "," ")})).join("┃"),s=n==t.length-1?"┗━━━┻━━━┻━━━┻━━━┻━━━┻━━━┻━━━┻━━━┛":"┣━━━╋━━━╋━━━╋━━━╋━━━╋━━━╋━━━╋━━━┫";return e+"\n".concat(8-n," ┃").concat(r,"┃\n  ").concat(s)}),"  ┏━━━┳━━━┳━━━┳━━━┳━━━┳━━━┳━━━┳━━━┓"),i=this.renInstance.graveyard.pieces.map((function(){return"━━━"})).join("┳"),n=this.renInstance.graveyard.pieces.map((function(t){return" ".concat(t?t.toString():" "," ")})).join("┃"),r=this.renInstance.graveyard.pieces.map((function(){return"━━━"})).join("┻"),s="  ┏".concat(i,"┓\n  ┃").concat(n,"┃\n  ┗").concat(r,"┛");return"".concat(e,"\n    a   b   c   d   e   f   g   h\n").concat(s)}},{key:"turn",value:function(){this.renInstance.turn}},{key:"move",value:function(t){}},{key:"undo",value:function(){return!1}},{key:"clear",value:function(){this.renInstance=c.toRen("4k3/8/8/8/8/8/8/3K4 w ---- -- -.- bhgqghbffffffffFFFFFFFFBHGQGHB")}},{key:"put",value:function(t,e){return null}},{key:"get",value:function(t){return null}},{key:"remove",value:function(t){return null}},{key:"history",value:function(){return this.kpgnInstance.moves}},{key:"addUpdateRenderEventListener",value:function(t){}},{key:"removeUpdateRenderEventListener",value:function(t){}}])&&n(e.prototype,i),t}();t.exports={KhmerChess:a}},163:(t,e,i)=>{function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function s(t,e,i){return e&&r(t.prototype,e),i&&r(t,i),t}function o(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var c=i(218).REN,a=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";n(this,t),o(this,"name",""),o(this,"id",""),this.id=e,this.name=i}return s(t,[{key:"toJson",value:function(){return{id:this.id,name:this.name}}}]),t}(),u=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;n(this,t),o(this,"win",0),o(this,"draw",0),o(this,"lost",0),this.win=e,this.draw=i,this.lost=r}return s(t,[{key:"toJson",value:function(){return{win:this.win,draw:this.draw,lost:this.lost}}}]),t}(),h=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"";n(this,t),o(this,"from",""),o(this,"to",""),o(this,"jump",!1),o(this,"capture",""),this.from=e,this.to=i,this.jump=r,this.capture=s}return s(t,[{key:"toJson",value:function(){return{from:this.from,to:this.to,jump:this.jump,capture:this.capture}}}]),t}(),l=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;n(this,t),o(this,"totalSecond",0),o(this,"currentWhite",0),o(this,"currentBlack",0),this.totalSecond=e,this.currentWhite=i,this.currentBlack=r}return s(t,[{key:"toJson",value:function(){return{totalSecond:this.totalSecond,currentWhite:this.currentWhite,currentBlack:this.currentBlack}}}]),t}(),E=function(){function t(e){n(this,t),o(this,"event",""),o(this,"date",""),o(this,"location",""),o(this,"players",{white:new a,black:new a}),o(this,"result",{last:{whiteWin:!1,blackWin:!1},white:new u}),o(this,"moves",[new h]),o(this,"ren",new c),o(this,"timer",new l)}return s(t,[{key:"toJson",value:function(){return{event:this.event,date:this.date,location:this.location,players:{white:this.players.white.toJson(),black:this.players.black.toJson()},result:{last:{whiteWin:this.result.last.whiteWin,blackWin:this.result.last.blackWin},white:this.result.white.toJson()},moves:this.moves.map((function(t){return t.toJson()})),ren:this.ren.toString(),timer:this.timer.toJson()}}}]),t}();t.exports={KPGN:E,Player:a,Result:u,Move:h,Timer:l}},218:(t,e,i)=>{function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function s(t,e,i){return e&&r(t.prototype,e),i&&r(t,i),t}function o(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var c=i(806).PIECE_TYPE_BORK,a=i(806),u=i(659),h="bhgqkghb/8/ffffffff/8/8/FFFFFFFF/8/BHGKQGHB",l="-",E=function(){function t(e,i){n(this,t),o(this,"type",a.PIECE_TYPE_TREY),o(this,"color",a.PIECE_COLOR_WHITE),u.isUndefined(i)&&(u.isUndefined(e)&&(e=a.toWhitePiece(a.PIECE_TYPE_TREY)),i=u.isUpperCase(e)?a.PIECE_COLOR_WHITE:a.PIECE_COLOR_BLACK,e=e.toLowerCase()),this.type=e,this.color=i}return s(t,[{key:"toOrigin",value:function(){return this.type==c?new t(this.color,a.PIECE_TYPE_TREY):this}},{key:"toString",value:function(){var t=this.type;return a.isWhite(this.color)&&(t=a.toWhitePiece(t)),t}}]),t}(),P=function(){function t(e,i,r){n(this,t),o(this,"h","a"),o(this,"v",1),o(this,"x",0),o(this,"y",0),o(this,"p",new E),this.p=e,u.isUndefined(r)&&(r=i.v,i=i.h),this.h=i,this.v=r,this.x=a.HORIZONTAL_CODE_LETTERS.indexOf(this.h),this.y=this.v-1}return s(t,[{key:"toString",value:function(){return"".concat(this.toPString()).concat(this.h).concat(this.v)}},{key:"toPString",value:function(){return u.isNull(this.p)?a.EMPTY_PIECE:this.p.toString()}}]),t}(),f=function(){function t(e){n(this,t),o(this,"poses",Array.from({length:a.getSubBoardNumber()},(function(t,e){var i=a.numToCodeP(e);return new P(null,i)}))),u.isUndefined(e)&&(e=h);var i=this.extract(e).replace(/\//g,"");if(i.length<a.getSubBoardNumber()||!a.isValidPiecesString(i))throw new Error("Invalid board string ".concat(e));this.poses=i.split("").map((function(t,e){var i=a.numToCodeP(e);return new P(t==a.EMPTY_PIECE?null:new E(t),i)}))}return s(t,[{key:"toMultiArray",value:function(){var t=[[],[],[],[],[],[],[],[]];return this.poses.forEach((function(e){t[e.y][e.x]=e.p})),t}},{key:"compress",value:function(t){var e=new RegExp("(\\".concat(a.EMPTY_PIECE,"+)"),"g");return t.replace(e,(function(t){return t.length}))}},{key:"extract",value:function(t){return t.replace(/(\d+)/g,(function(t){return Array.from({length:t},(function(){return a.EMPTY_PIECE})).join("")}))}},{key:"toStringFull",value:function(){return this.poses.map((function(t,e){var i=t.toPString();return e&&e%8==0&&e!=a.getSubBoardNumber()?"".concat(a.BOARD_SEPARATOR).concat(i):i})).join("")}},{key:"toString",value:function(){var t=this.toStringFull();return this.compress(t)}}]),t}(),g=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";n(this,t),o(this,"whiteKing",!1),o(this,"whiteQueen",!1),o(this,"blackKing",!1),o(this,"blackQueen",!1);var i=a;this.whiteKing=!!~e.indexOf(i.toWhitePiece(i.PIECE_TYPE_SDECH)),this.whiteQueen=!!~e.indexOf(i.toWhitePiece(i.PIECE_TYPE_NEANG)),this.blackKing=!!~e.indexOf(i.PIECE_TYPE_SDECH),this.blackQueen=!!~e.indexOf(i.PIECE_TYPE_NEANG)}return s(t,[{key:"toString",value:function(){var t="".concat(this.whiteKing?a.toWhitePiece(a.PIECE_TYPE_SDECH):l);return t+="".concat(this.whiteQueen?a.toWhitePiece(a.PIECE_TYPE_NEANG):l),(t+="".concat(this.blackKing?a.PIECE_TYPE_SDECH:l))+"".concat(this.blackQueen?a.PIECE_TYPE_NEANG:l)}}]),t}(),C=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";n(this,t),o(this,"whiteKing",!1),o(this,"blackKing",!1);var i=a;this.whiteKing=!!~e.indexOf(i.toWhitePiece(i.PIECE_TYPE_SDECH)),this.blackKing=!!~e.indexOf(i.PIECE_TYPE_SDECH)}return s(t,[{key:"toString",value:function(){return"".concat(this.whiteKing?a.toWhitePiece(a.PIECE_TYPE_SDECH):l)+"".concat(this.blackKing?a.PIECE_TYPE_SDECH:l)}}]),t}(),_=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";n(this,t),o(this,"white",null),o(this,"black",null);var i=e.split(".");if(this.white=u.isStringNumber(i[0])?Number(i[0]):null,this.black=u.isStringNumber(i[1])?Number(i[1]):null,!u.isNull(this.white)&&!u.isNull(this.white))throw new Error("Invalid countdown string ".concat(e))}return s(t,[{key:"toString",value:function(){return"".concat(u.isNull(this.white)?l:this.white)+".".concat(u.isNull(this.black)?l:this.black)}}]),t}(),v=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";if(n(this,t),o(this,"pieces",[]),e.length>30||!a.isValidPiecesString(e,!0))throw new Error("Invalid graveyard string ".concat(e));this.pieces=e.split("").map((function(t,i){var n=new E(t);if(n.type==a.PIECE_TYPE_SDECH)throw new Error("King cannot die graveyard:".concat(e));return n}))}return s(t,[{key:"toString",value:function(){return this.pieces.map((function(t){return t.toString()})).join("")}}]),t}(),d=function(){function t(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:a.PIECE_COLOR_WHITE,r=arguments.length>2?arguments[2]:void 0,s=arguments.length>3?arguments[3]:void 0,c=arguments.length>4?arguments[4]:void 0,u=arguments.length>5?arguments[5]:void 0;n(this,t),o(this,"board",new f),o(this,"turn",a.PIECE_COLOR_WHITE),o(this,"kqMoved",new g),o(this,"kAttacked",new C),o(this,"countdown",new _),o(this,"graveyard",new v),this.board=new f(e),this.turn=i,this.kqMoved=new g(r),this.kqMoved=new C(s),this.countdown=new _(c),this.graveyard=new v(u);var h=this.isInvalidPieceCount();if(h)throw new Error("Invalid piece string board:".concat(e,", graveyard:").concat(u,", count:").concat(h))}return s(t,[{key:"isInvalidPieceCount",value:function(){var t=this.board.poses.map((function(t){return t.p})).filter((function(t){return!u.isNull(t)})).concat(this.graveyard.pieces).map((function(t){return t.toOrigin()})).reduce((function(t,e){return t[e.toString()]=t[e.toString()]||0,t[e.toString()]++,t}),{}),e=Object.keys(t).map((function(e){return"".concat(e).concat(t[e])})).sort().join("");return"B2F8G2H2K1Q1b2f8g2h2k1q1"!=e&&e}},{key:"toString",value:function(){var t=this.board.toString();return t+=" ".concat(this.turn.toString()),t+=" ".concat(this.kqMoved.toString()),t+=" ".concat(this.kAttacked.toString()),(t+=" ".concat(this.countdown.toString()))+" ".concat(this.graveyard.toString())}}]),t}();t.exports={Piece:E,Pos:P,Board:f,KqMoved:g,CountDown:_,Graveyard:v,REN:d,DEFAULT_BOARD_STR:h}},806:(t,e,i)=>{function n(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function r(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var s=i(659),o=i(922),c=function(){function t(e,i,n,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.x=e,this.y=i,this.width=n,this.height=r}var e,i;return e=t,(i=[{key:"isContainsPoint",value:function(t){var e=t.x,i=t.y;return this.x<=e&&this.x+this.width>=e&&this.y<=i&&this.y+this.height>=i}}])&&r(e.prototype,i),t}(),a=null,u={HORIZONTAL_CODE_LETTERS:"abcdefgh",PIECE_COLOR_WHITE:"w",PIECE_COLOR_BLACK:"b",PIECE_TYPE_TOUK:"b",PIECE_TYPE_SES:"h",PIECE_TYPE_KOL:"g",PIECE_TYPE_SDECH:"k",PIECE_TYPE_NEANG:"q",PIECE_TYPE_TREY:"f",PIECE_TYPE_BORK:"t",EMPTY_PIECE:".",BOARD_SEPARATOR:"/",ROW_NUMBER:8,ROW_FIRST_INDEX:0,ROW_LAST_INDEX:7,mask:null,isValidPiecesString:function(t,e){var i=this;s.isNull(a)&&(a=[this.PIECE_TYPE_TOUK,this.PIECE_TYPE_SES,this.PIECE_TYPE_KOL,this.PIECE_TYPE_SDECH,this.PIECE_TYPE_NEANG,this.PIECE_TYPE_TREY,this.PIECE_TYPE_BORK,this.toWhitePiece(this.PIECE_TYPE_TOUK),this.toWhitePiece(this.PIECE_TYPE_SES),this.toWhitePiece(this.PIECE_TYPE_KOL),this.toWhitePiece(this.PIECE_TYPE_SDECH),this.toWhitePiece(this.PIECE_TYPE_NEANG),this.toWhitePiece(this.PIECE_TYPE_TREY),this.toWhitePiece(this.PIECE_TYPE_BORK),this.EMPTY_PIECE,this.BOARD_SEPARATOR]);var n=e?a.filter((function(t){return!~[i.EMPTY_PIECE,i.BOARD_SEPARATOR].indexOf(t)})):a;return!t.split("").some((function(t){return!~n.indexOf(t)}))},toWhitePiece:function(t){return t.toUpperCase()},isValidPosXY:function(t,e){return!s.isUndefined(t)&&(s.isUndefined(e)||(t=this.p(t,e)),!s.isUndefined(t.x)&&!s.isUndefined(t.y)&&this.rect(0,0,this.ROW_LAST_INDEX,this.ROW_LAST_INDEX).isContainsPoint(t))},isValidPiece:function(t){return t!=u.EMPTY_PIECE},isWhite:function(t){return t===u.PIECE_COLOR_WHITE},isBlack:function(t){return t===u.PIECE_COLOR_BLACK},codeP:function(t,e){return{h:t,v:e}},p:function(t,e){return{x:t,y:e}},res:function(t,e){return{width:t,height:e}},rect:function(t,e,i,n){return new c(t,e,i,n)},getSubBoardNumber:function(){return u.ROW_NUMBER*u.ROW_NUMBER},nerdPosToXY:function(t){if(s.isNumber(t.x)&&s.isNumber(t.y))return t;if(s.isNumber(t)){var e=t%this.ROW_NUMBER,i=Math.floor(t/this.ROW_NUMBER);return this.p(e,i)}return null},nerdXyToPos:function(t,e){return s.isUndefined(e)?t.x+t.y*this.ROW_NUMBER:t+e*this.ROW_NUMBER},isPosInBoard:function(t){return s.isNumber(t)&&t>=0&&t<=this.getSubBoardNumber()-1},getCharPieceFromString:function(t,e){return this.isPosInBoard(e)&&t.length===this.getSubBoardNumber()?t.charAt(e):this.EMPTY_PIECE},getPieceProperties:function(t){var e=this.pieceHash[t];return{color:e?e[0]:this.PIECE_COLOR_EMPTY,type:e?e[1]:this.EMPTY_PIECE}},getCharPieceInPos:function(t,e){return this.getCharPieceFromString(e,t)},getPieceInPos:function(t,e,i){s.isNumber(e)?t=this.nerdXyToPos(t,e):s.isString(e)&&(i=e);var n=this.getCharPieceInPos(t,i),r=this.PIECE_COLOR_WHITE,o=this.PIECE_TYPE_TREY;if(this.isValidPiece(n)){var c=this.getPieceProperties(n);r=c.color,o=c.type}return{isValidPiece:this.isValidPiece(n),color:r,type:o}},convertMask:function(t,e,i){var n=this.isWhite(i)?1:-1;return e=this.nerdPosToXY(e),t.x=t.x*n+e.x,t.y=t.y*n+e.y,this.isValidPosXY(t)?this.nerdXyToPos(t):null},getPieceCanMovePoses:function(t,e,i){var n=this,r=[];return this.mask=this.mask||o(this),this.mask[t].forEach((function(t){var o=n.convertMask(n.p(t[0],t[1]),e,i);s.isNull(o)||r.push(o)})),r},getPieceCanMovePosesValid:function(t,e,i,n){for(var r,o,c=this.getPieceCanMovePoses(t,e,i),a=[],u=c.length,h=this.nerdPosToXY(e),l=0;l<u;l++){if(r=this.nerdPosToXY(c[l]),(o=this.getPieceInPos(r.x,r.y,n)).isValidPiece?(i===o.color||t===this.PIECE_TYPE_TREY&&r.x===h.x)&&(r=null):t===this.PIECE_TYPE_TREY&&r.x!=h.x&&(r=null),!s.isNull(r)&&t===this.PIECE_TYPE_TOUK){var E=h.x,P=h.y,f=void 0,g=void 0;if(r.x===h.x){for(f=Math.abs(r.y-h.y),g=h.y<r.y?1:-1;--f>0;)if(this.getPieceInPos(E,P+g*f,n).isValidPiece){r=null;break}}else if(r.y===h.y)for(f=Math.abs(r.x-h.x),g=h.x<r.x?1:-1;--f>0;)if(this.getPieceInPos(E+g*f,P,n).isValidPiece){r=null;break}}s.isNull(r)||a.push(c[l])}return a},replacePiecesString:function(t,e,i){return t.substring(0,i)+e+t.substring(i+1)},injectPiece:function(t,e,i){var n=t.charAt(e);return this.isCharPiecesInBoard(n,t)?(t=this.replacePiecesString(t,this.EMPTY_PIECE,e),t=this.replacePiecesString(t,n,i)):null},getPieceCode:function(t,e){var i=t+e;for(var n in this.pieceHash)if(i===this.pieceHash[n])return n;return this.EMPTY_PIECE},getKingWillInDanger:function(t,e){for(var i,n,r,s=e.indexOf(this.getPieceCode(t,this.PIECE_TYPE_SDECH)),o=e.length,c=0;c<o;c++)if((n=this.getPieceInPos(c,e)).isValidPiece&&n.color!=t&&n.type===this.PIECE_TYPE_TOUK)for(i=this.getPieceCanMovePoses(n.type,c,n.color,e),r=0;r<i.length;r++)if(i[r]===s)return[this.numToCode(c),this.numToCode(s)];return null},getKingInDanger:function(t,e){for(var i,n,r,s=e.indexOf(this.getPieceCode(t,this.PIECE_TYPE_SDECH)),o=e.length,c=0;c<o;c++)if((n=this.getPieceInPos(c,e)).isValidPiece&&n.color!=t)for(i=this.getPieceCanMovePosesValid(n.type,c,n.color,e),r=0;r<i.length;r++)if(i[r]===s)return[this.numToCode(c),this.numToCode(s)];return null},numToCodeP:function(t){return this.codeP(this.HORIZONTAL_CODE_LETTERS[t%8],1+(t/8|0))},numToCode:function(t){var e=this.numToCodeP(t);return"".concat(e.h).concat(e.v)},generatePosesCanMove:function(t,e,i,n,r){var o,c=this.getPieceCanMovePosesValid(t,e,i,n),a=this.isHaveCaptured(n);t===this.PIECE_TYPE_SDECH?a||r||((o=this.convertMask(this.p(2,1),e,i))&&!this.getPieceInPos(o,n).isValidPiece&&c.push(o),(o=this.convertMask(this.p(-2,1),e,i))&&!this.getPieceInPos(o,n).isValidPiece&&c.push(o)):t===this.PIECE_TYPE_NEANG&&(a||r||(o=this.convertMask(this.p(-0,2),e,i))&&!this.getPieceInPos(o,n).isValidPiece&&c.push(o));for(var u,h=c.length,l=[],E=0;E<h;E++)u=this.injectPiece(n,e,c[E]),s.isNull(this.getKingInDanger(i,u))&&l.push(this.numToCode(c[E]));return l},isCharPiecesInBoard:function(t,e){return!!~e.indexOf(t)},getPiecesInBoard:function(t){var e=this;return t.split("").filter((function(t){return e.isValidPiece(t)}))},isHaveCaptured:function(t){return this.getPiecesInBoard(t).length<4*this.ROW_NUMBER},filterPieceInBoard:function(t){for(var e,i,n,r=[],s=[],o=0;o<t.length;o++)e=t.charAt(o),this.isValidPiece(e)&&(n={color:(i=this.getPieceProperties(e)).color,type:i.type,index:o,code:this.numToCode(o)},this.isWhite(n.color)?r.push(n):s.push(n));return{whitePieces:r,blackPieces:s}},extractPiecesToArray:function(t){var e,i=this;t=t.split("");var r=(n(e={},this.PIECE_COLOR_BLACK,[]),n(e,this.PIECE_COLOR_WHITE,[]),e);return t.forEach((function(t){if(t!==i.EMPTY_PIECE){var e=i.getPieceProperties(t);r[e.color].push(e.type)}})),r},isStateCount:function(t,e){return 1===this.extractPiecesToArray(e)[t].length},checkCountable:function(t,e){var i=this.extractPiecesToArray(e),n=i[t],r=i[this.oppositeColor(t)];return n.length<=2&&r.length>=2},checkCount:function(t,e,i){var n,r,s=function(t,e){return t.join("").split(e).length-1},o=this.extractPiecesToArray(e),c=o[t],a=o[this.oppositeColor(t)];if(1===c.length&&a.length>1){if(n=a,r=this.PIECE_TYPE_TREY,!~n.indexOf(r)){var u=64,h=s(a,this.PIECE_TYPE_TOUK);return h?u=h>1?8:16:s(a,this.PIECE_TYPE_KOL)>1?u=22:s(a,this.PIECE_TYPE_SES)>1?u=32:s(a,this.PIECE_TYPE_KOL)&&(u=44),[a.length+1,u]}return[0,64]}return i&&this.checkCountable(t,e)?[0,64]:null},getHashKey:function(t){var e=this,i=Object.keys(this.pieceHash).filter((function(i){return e.pieceHash[i]===t}));return 1===i.length?i[0]:this.EMPTY_PIECE},getPieceKeyByProp:function(t){var e;for(var i in this.pieceHash)if(e=this.getPieceProperties(i),t.color===e.color&&t.type===e.type)return i;return this.EMPTY_PIECE},getPieceKeyByName:function(t){return this.getPieceKeyByProp({color:t[0],type:t[1]})},oppositeColor:function(t){return this.isWhite(t)?this.PIECE_COLOR_BLACK:this.PIECE_COLOR_WHITE}};u.pieceHash={a:u.PIECE_COLOR_WHITE+u.PIECE_TYPE_TOUK,b:u.PIECE_COLOR_WHITE+u.PIECE_TYPE_SES,c:u.PIECE_COLOR_WHITE+u.PIECE_TYPE_KOL,d:u.PIECE_COLOR_WHITE+u.PIECE_TYPE_SDECH,e:u.PIECE_COLOR_WHITE+u.PIECE_TYPE_NEANG,f:u.PIECE_COLOR_WHITE+u.PIECE_TYPE_TREY,g:u.PIECE_COLOR_WHITE+u.PIECE_TYPE_BORK,h:u.PIECE_COLOR_BLACK+u.PIECE_TYPE_TOUK,i:u.PIECE_COLOR_BLACK+u.PIECE_TYPE_SES,j:u.PIECE_COLOR_BLACK+u.PIECE_TYPE_KOL,k:u.PIECE_COLOR_BLACK+u.PIECE_TYPE_SDECH,l:u.PIECE_COLOR_BLACK+u.PIECE_TYPE_NEANG,m:u.PIECE_COLOR_BLACK+u.PIECE_TYPE_TREY,n:u.PIECE_COLOR_BLACK+u.PIECE_TYPE_BORK},t.exports=u},922:(t,e,i)=>{var n=i(806);t.exports=function(){var t={};return t[n.PIECE_TYPE_TOUK]=[[0,1],[0,2],[0,3],[0,4],[0,5],[0,6],[0,7],[0,8],[0,-1],[0,-2],[0,-3],[0,-4],[0,-5],[0,-6],[0,-7],[0,-8],[1,0],[2,0],[3,0],[4,0],[5,0],[6,0],[7,0],[8,0],[-1,0],[-2,0],[-3,0],[-4,0],[-5,0],[-6,0],[-7,0],[-8,0]],t[n.PIECE_TYPE_SES]=[[-1,-2],[1,-2],[-2,-1],[2,-1],[-1,2],[1,2],[-2,1],[2,1]],t[n.PIECE_TYPE_NEANG]=[[-1,-1],[1,-1],[-1,1],[1,1]],t[n.PIECE_TYPE_KOL]=t[n.PIECE_TYPE_NEANG].concat([[0,1]]),t[n.PIECE_TYPE_SDECH]=t[n.PIECE_TYPE_KOL].concat([[0,-1],[1,0],[-1,0]]),t[n.PIECE_TYPE_TREY]=[[0,1],[-1,1],[1,1]],t[n.PIECE_TYPE_BORK]=t[n.PIECE_TYPE_NEANG],t}},659:t=>{var e={isValid:function(t){return!this.isNull(t)&&!this.isUndefined(t)},isNull:function(t){return null===t},isUndefined:function(t){return void 0===t},isString:function(t){return this.isValid(t)&&"string"==typeof t},isNotEmpty:function(t){return this.isValidString(t)&&""!=t},isNumber:function(t){return this.isValid(t)&&"number"==typeof t},isStringNumber:function(t){return this.isString(t)&&""!=t&&!isNaN(Number(t))},isArray:function(t){return this.isValid(t)&&t instanceof Array},isFunction:function(t){return this.isValid(t)&&"function"==typeof t},isObject:function(t){return this.isValid(t)&&t instanceof Object},isBoolean:function(t){return this.isValid(t)&&"boolean"==typeof t},isTrue:function(t){return this.isValidBoolean(t)&&t},isFalse:function(t){return this.isValidBoolean(t)&&!t},isPoint:function(t){return this.isValid(t)&&this.isValidObject(t)&&this.isValidNumber(t.x)&&this.isValidNumber(t.y)},isSize:function(t){return this.isValid(t)&&this.isValidObject(t)&&this.isValidNumber(t.width)&&this.isValidNumber(t.height)},isOdd:function(t){return!!(t%2)},isEven:function(t){return!this.isOdd(t)},isUpperCase:function(t){return t===t.toUpperCase()}};t.exports=e},620:(t,e,i)=>{function n(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var r=i(806),s=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,i;return e=t,(i=[{key:"init",value:function(t){this.piecesString=t.piecesString,this.currentTurn=t.currentTurn,this.isNeangMoved=t.isNeangMoved,this.isSdechMoved=t.isSdechMoved,this.genCanMove=t.genCanMove,this.genCanMoveForAnother=t.genCanMoveForAnother,this.whiteMoves=[],this.blackMoves=[],this.whiteKingInDanger=null,this.whiteKingWillInDanger=null,this.blackKingInDanger=null,this.blackKingWillInDanger=null,this.winColor=null,this.stuckColor=null}},{key:"generateCanMoves",value:function(){var t=this,e=r.filterPieceInBoard(this.piecesString);this.whiteMoves=e.whitePieces,this.blackMoves=e.blackPieces;var i=function(e){for(var i=0;i<e.length;i++){var n=e[i].type,s=n===r.PIECE_TYPE_SDECH,o=n===r.PIECE_TYPE_NEANG,c=t.isSdechMoved;s||(c=!!o&&t.isNeangMoved);var a=r.generatePosesCanMove(n,e[i].index,e[i].color,t.piecesString,c);e[i].canMoveIndexes=a}};i(this.whiteMoves),i(this.blackMoves)}},{key:"cleanPieceNoMove",value:function(){var t=function(t){for(var e=!0;e;){e=!1;for(var i=0;i<t.length;i++){var n=t[i];if(!n.canMoveIndexes||!n.canMoveIndexes.length){t.splice(i,1),e=!0;break}}}};t(this.whiteMoves),t(this.blackMoves)}},{key:"checkIfKingInDanger",value:function(){this.whiteKingInDanger=r.getKingInDanger(r.PIECE_COLOR_WHITE,this.piecesString),this.whiteKingWillInDanger=r.getKingWillInDanger(r.PIECE_COLOR_WHITE,this.piecesString),this.blackKingInDanger=r.getKingInDanger(r.PIECE_COLOR_BLACK,this.piecesString),this.blackKingWillInDanger=r.getKingWillInDanger(r.PIECE_COLOR_BLACK,this.piecesString)}},{key:"genWinLost",value:function(){this.whiteKingInDanger&&!this.whiteMoves.length?this.winColor=r.PIECE_COLOR_BLACK:this.blackKingInDanger&&!this.blackMoves.length&&(this.winColor=r.PIECE_COLOR_WHITE)}},{key:"getStuck",value:function(){this.winColor||(r.isWhite(this.currentTurn)&&!this.whiteMoves.length?this.stuckColor=r.PIECE_COLOR_WHITE:r.isBlack(this.currentTurn)&&!this.blackMoves.length&&(this.stuckColor=r.PIECE_COLOR_BLACK))}},{key:"calcCanMove",value:function(t){this.init(t),this.generateCanMoves(),this.cleanPieceNoMove();var e=[];this.genCanMove&&(e=r.isWhite(this.currentTurn)?this.whiteMoves:this.blackMoves);var i=[];return this.genCanMoveForAnother&&(i=r.isBlack(this.currentTurn)?this.whiteMoves:this.blackMoves),{moves:e,anotherMoves:i}}},{key:"calcState",value:function(t){return this.init(t),this.generateCanMoves(),this.cleanPieceNoMove(),this.checkIfKingInDanger(),this.genWinLost(),this.getStuck(),{blackKingInDanger:this.blackKingInDanger,whiteKingInDanger:this.whiteKingInDanger,blackKingWillInDanger:this.blackKingWillInDanger,whiteKingWillInDanger:this.whiteKingWillInDanger,winColor:this.winColor,stuckColor:this.stuckColor,blackCountable:r.checkCountable(r.PIECE_COLOR_BLACK,this.piecesString),whiteCountable:r.checkCountable(r.PIECE_COLOR_WHITE,this.piecesString)}}},{key:"calCount",value:function(t){return{countingBlack:r.checkCount(r.PIECE_COLOR_BLACK,t.piecesString,t.force),countingWhite:r.checkCount(r.PIECE_COLOR_WHITE,t.piecesString,t.force)}}}])&&n(e.prototype,i),t}();t.exports=s},490:(t,e,i)=>{var n=i(218),r=n.REN,s=n.DEFAULT_BOARD_STR,o=i(659),c={toRen:function(t){o.isUndefined(t)&&(t=s);var e=t.split(" ");return new r(e[0],e[1],e[2],e[3],e[4],e[5])}};t.exports=c}},e={};!function i(n){if(e[n])return e[n].exports;var r=e[n]={exports:{}};return t[n](r,r.exports,i),r.exports}(497)})();